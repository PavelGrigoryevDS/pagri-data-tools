
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../pagri_graphs/">
      
      
        <link rel="next" href="../pagri_nb_tools/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>pagri_stats - Pagri Data Tools</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2afb09e1.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pagri_stats" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Pagri Data Tools" class="md-header__button md-logo" aria-label="Pagri Data Tools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pagri Data Tools
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              pagri_stats
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../pagri_prep/" class="md-tabs__link">
          
  
  
  Modules

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Pagri Data Tools" class="md-nav__button md-logo" aria-label="Pagri Data Tools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Pagri Data Tools
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pagri_prep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pagri_prep
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pagri_graphs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pagri_graphs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    pagri_stats
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    pagri_stats
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats" class="md-nav__link">
    <span class="md-ellipsis">
      pagri_stats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pagri_stats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.anova_oneway" class="md-nav__link">
    <span class="md-ellipsis">
      anova_oneway
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.anova_oneway_df" class="md-nav__link">
    <span class="md-ellipsis">
      anova_oneway_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.anova_oneway_report" class="md-nav__link">
    <span class="md-ellipsis">
      anova_oneway_report
    </span>
  </a>
  
    <nav class="md-nav" aria-label="anova_oneway_report">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.anova_oneway_report--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.anova_oneway_report--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.anova_oneway_welch_df" class="md-nav__link">
    <span class="md-ellipsis">
      anova_oneway_welch_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.bartlett" class="md-nav__link">
    <span class="md-ellipsis">
      bartlett
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.bartlett_df" class="md-nav__link">
    <span class="md-ellipsis">
      bartlett_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.bootstrap_diff_2sample" class="md-nav__link">
    <span class="md-ellipsis">
      bootstrap_diff_2sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.bootstrap_single_sample" class="md-nav__link">
    <span class="md-ellipsis">
      bootstrap_single_sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.calculate_cohens_d" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_cohens_d
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.chi2_pearson" class="md-nav__link">
    <span class="md-ellipsis">
      chi2_pearson
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.chisquare" class="md-nav__link">
    <span class="md-ellipsis">
      chisquare
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_2sample_statsmodels" class="md-nav__link">
    <span class="md-ellipsis">
      confint_proportion_2sample_statsmodels
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_proportion_2sample_statsmodels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_2sample_statsmodels--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_coluns_2sample_statsmodels" class="md-nav__link">
    <span class="md-ellipsis">
      confint_proportion_coluns_2sample_statsmodels
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_proportion_coluns_2sample_statsmodels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_coluns_2sample_statsmodels--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_1sample" class="md-nav__link">
    <span class="md-ellipsis">
      confint_proportion_ztest_1sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_proportion_ztest_1sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_1sample--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_1sample_column" class="md-nav__link">
    <span class="md-ellipsis">
      confint_proportion_ztest_1sample_column
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_proportion_ztest_1sample_column">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_1sample_column--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_2sample" class="md-nav__link">
    <span class="md-ellipsis">
      confint_proportion_ztest_2sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_proportion_ztest_2sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_2sample--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_column_2sample" class="md-nav__link">
    <span class="md-ellipsis">
      confint_proportion_ztest_column_2sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_proportion_ztest_column_2sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_column_2sample--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_t_1sample" class="md-nav__link">
    <span class="md-ellipsis">
      confint_t_1sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_t_1sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_t_1sample--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_t_2samples" class="md-nav__link">
    <span class="md-ellipsis">
      confint_t_2samples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_t_2samples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_t_2samples--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_t_2samples_df" class="md-nav__link">
    <span class="md-ellipsis">
      confint_t_2samples_df
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_t_2samples_df">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_t_2samples_df--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.dunn_df" class="md-nav__link">
    <span class="md-ellipsis">
      dunn_df
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dunn_df">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.dunn_df--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.dunn_df--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.games_howell_df" class="md-nav__link">
    <span class="md-ellipsis">
      games_howell_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal" class="md-nav__link">
    <span class="md-ellipsis">
      kruskal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal_df" class="md-nav__link">
    <span class="md-ellipsis">
      kruskal_df
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kruskal_df">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal_df--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal_df--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal_report" class="md-nav__link">
    <span class="md-ellipsis">
      kruskal_report
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kruskal_report">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal_report--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal_report--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.levene" class="md-nav__link">
    <span class="md-ellipsis">
      levene
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.levene_df" class="md-nav__link">
    <span class="md-ellipsis">
      levene_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.linear_regression_with_vif" class="md-nav__link">
    <span class="md-ellipsis">
      linear_regression_with_vif
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.mannwhitneyu" class="md-nav__link">
    <span class="md-ellipsis">
      mannwhitneyu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.mannwhitneyu_df" class="md-nav__link">
    <span class="md-ellipsis">
      mannwhitneyu_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.mannwhitneyu_report" class="md-nav__link">
    <span class="md-ellipsis">
      mannwhitneyu_report
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mannwhitneyu_report">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.mannwhitneyu_report--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.mannwhitneyu_report--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.plot_feature_importances_classifier" class="md-nav__link">
    <span class="md-ellipsis">
      plot_feature_importances_classifier
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.plot_feature_importances_regression" class="md-nav__link">
    <span class="md-ellipsis">
      plot_feature_importances_regression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.proportion_ztest_1sample" class="md-nav__link">
    <span class="md-ellipsis">
      proportion_ztest_1sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.proportions_chi2" class="md-nav__link">
    <span class="md-ellipsis">
      proportions_chi2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.proportions_chi2_column" class="md-nav__link">
    <span class="md-ellipsis">
      proportions_chi2_column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.proportions_ztest_2sample" class="md-nav__link">
    <span class="md-ellipsis">
      proportions_ztest_2sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.proportions_ztest_column_2sample" class="md-nav__link">
    <span class="md-ellipsis">
      proportions_ztest_column_2sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.ttest_ind" class="md-nav__link">
    <span class="md-ellipsis">
      ttest_ind
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.ttest_ind_df" class="md-nav__link">
    <span class="md-ellipsis">
      ttest_ind_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.ttest_ind_report" class="md-nav__link">
    <span class="md-ellipsis">
      ttest_ind_report
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ttest_ind_report">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.ttest_ind_report--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.ttest_ind_report--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.tukey_hsd_df" class="md-nav__link">
    <span class="md-ellipsis">
      tukey_hsd_df
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pagri_nb_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pagri_nb_tools
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats" class="md-nav__link">
    <span class="md-ellipsis">
      pagri_stats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pagri_stats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.anova_oneway" class="md-nav__link">
    <span class="md-ellipsis">
      anova_oneway
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.anova_oneway_df" class="md-nav__link">
    <span class="md-ellipsis">
      anova_oneway_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.anova_oneway_report" class="md-nav__link">
    <span class="md-ellipsis">
      anova_oneway_report
    </span>
  </a>
  
    <nav class="md-nav" aria-label="anova_oneway_report">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.anova_oneway_report--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.anova_oneway_report--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.anova_oneway_welch_df" class="md-nav__link">
    <span class="md-ellipsis">
      anova_oneway_welch_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.bartlett" class="md-nav__link">
    <span class="md-ellipsis">
      bartlett
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.bartlett_df" class="md-nav__link">
    <span class="md-ellipsis">
      bartlett_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.bootstrap_diff_2sample" class="md-nav__link">
    <span class="md-ellipsis">
      bootstrap_diff_2sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.bootstrap_single_sample" class="md-nav__link">
    <span class="md-ellipsis">
      bootstrap_single_sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.calculate_cohens_d" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_cohens_d
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.chi2_pearson" class="md-nav__link">
    <span class="md-ellipsis">
      chi2_pearson
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.chisquare" class="md-nav__link">
    <span class="md-ellipsis">
      chisquare
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_2sample_statsmodels" class="md-nav__link">
    <span class="md-ellipsis">
      confint_proportion_2sample_statsmodels
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_proportion_2sample_statsmodels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_2sample_statsmodels--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_coluns_2sample_statsmodels" class="md-nav__link">
    <span class="md-ellipsis">
      confint_proportion_coluns_2sample_statsmodels
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_proportion_coluns_2sample_statsmodels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_coluns_2sample_statsmodels--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_1sample" class="md-nav__link">
    <span class="md-ellipsis">
      confint_proportion_ztest_1sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_proportion_ztest_1sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_1sample--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_1sample_column" class="md-nav__link">
    <span class="md-ellipsis">
      confint_proportion_ztest_1sample_column
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_proportion_ztest_1sample_column">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_1sample_column--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_2sample" class="md-nav__link">
    <span class="md-ellipsis">
      confint_proportion_ztest_2sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_proportion_ztest_2sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_2sample--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_column_2sample" class="md-nav__link">
    <span class="md-ellipsis">
      confint_proportion_ztest_column_2sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_proportion_ztest_column_2sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_proportion_ztest_column_2sample--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_t_1sample" class="md-nav__link">
    <span class="md-ellipsis">
      confint_t_1sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_t_1sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_t_1sample--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_t_2samples" class="md-nav__link">
    <span class="md-ellipsis">
      confint_t_2samples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_t_2samples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_t_2samples--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_t_2samples_df" class="md-nav__link">
    <span class="md-ellipsis">
      confint_t_2samples_df
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confint_t_2samples_df">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.confint_t_2samples_df--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.dunn_df" class="md-nav__link">
    <span class="md-ellipsis">
      dunn_df
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dunn_df">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.dunn_df--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.dunn_df--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.games_howell_df" class="md-nav__link">
    <span class="md-ellipsis">
      games_howell_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal" class="md-nav__link">
    <span class="md-ellipsis">
      kruskal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal_df" class="md-nav__link">
    <span class="md-ellipsis">
      kruskal_df
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kruskal_df">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal_df--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal_df--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal_report" class="md-nav__link">
    <span class="md-ellipsis">
      kruskal_report
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kruskal_report">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal_report--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.kruskal_report--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.levene" class="md-nav__link">
    <span class="md-ellipsis">
      levene
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.levene_df" class="md-nav__link">
    <span class="md-ellipsis">
      levene_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.linear_regression_with_vif" class="md-nav__link">
    <span class="md-ellipsis">
      linear_regression_with_vif
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.mannwhitneyu" class="md-nav__link">
    <span class="md-ellipsis">
      mannwhitneyu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.mannwhitneyu_df" class="md-nav__link">
    <span class="md-ellipsis">
      mannwhitneyu_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.mannwhitneyu_report" class="md-nav__link">
    <span class="md-ellipsis">
      mannwhitneyu_report
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mannwhitneyu_report">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.mannwhitneyu_report--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.mannwhitneyu_report--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.plot_feature_importances_classifier" class="md-nav__link">
    <span class="md-ellipsis">
      plot_feature_importances_classifier
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.plot_feature_importances_regression" class="md-nav__link">
    <span class="md-ellipsis">
      plot_feature_importances_regression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.proportion_ztest_1sample" class="md-nav__link">
    <span class="md-ellipsis">
      proportion_ztest_1sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.proportions_chi2" class="md-nav__link">
    <span class="md-ellipsis">
      proportions_chi2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.proportions_chi2_column" class="md-nav__link">
    <span class="md-ellipsis">
      proportions_chi2_column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.proportions_ztest_2sample" class="md-nav__link">
    <span class="md-ellipsis">
      proportions_ztest_2sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.proportions_ztest_column_2sample" class="md-nav__link">
    <span class="md-ellipsis">
      proportions_ztest_column_2sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.ttest_ind" class="md-nav__link">
    <span class="md-ellipsis">
      ttest_ind
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.ttest_ind_df" class="md-nav__link">
    <span class="md-ellipsis">
      ttest_ind_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.ttest_ind_report" class="md-nav__link">
    <span class="md-ellipsis">
      ttest_ind_report
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ttest_ind_report">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.ttest_ind_report--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.ttest_ind_report--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagri_data_tools.pagri_stats.tukey_hsd_df" class="md-nav__link">
    <span class="md-ellipsis">
      tukey_hsd_df
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="pagri_stats">pagri_stats</h1>


<div class="doc doc-object doc-module">



<h3 id="pagri_data_tools.pagri_stats" class="doc doc-heading">
            <code>pagri_data_tools.pagri_stats</code>


</h3>

    <div class="doc doc-contents first">









  <div class="doc doc-children">







<h4 id="pagri_data_tools.pagri_stats-functions">Functions</h4>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.anova_oneway" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">anova_oneway</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a one-way ANOVA test.</p>
<p>Parameters:
- samples (list): List of pd.Series, where each pd.Series contains values. There must be at least two samples.
- alpha (float, optional): Significance level (default: 0.05)
- return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False)</p>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - statistic : (float)
        The calculated F-statistic.
    - pvalue : (float)
        The associated p-value from the F distribution</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">anova_oneway</span><span class="p">(</span><span class="n">samples</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a one-way ANOVA test.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - samples (list): List of pd.Series, where each pd.Series contains values. There must be at least two samples.</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False)</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - statistic : (float)</span>
<span class="sd">            The calculated F-statistic.</span>
<span class="sd">        - pvalue : (float)</span>
<span class="sd">            The associated p-value from the F distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input samples must be a list of pd.Series&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All values in samples must be numeric&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All samples must have at least one value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must have at least two samples&quot;</span><span class="p">)</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">f_oneway</span><span class="p">(</span><span class="o">*</span><span class="n">samples</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Однофакторный ANOVA&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.anova_oneway_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">anova_oneway_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a one-way ANOVA test.</p>
        <ul>
<li>df (pd.DataFrame): DataFrame containing two columns,
    where the first column contains labels and
    the second column contains corresponding values</li>
<li>alpha (float, optional): Significance level (default: 0.05)</li>
<li>return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False).</li>
</ul>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - statistic : (float)
        The calculated F-statistic.
    - pvalue : (float)
        The associated p-value from the F distribution</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">anova_oneway_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a one-way ANOVA test.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - df (pd.DataFrame): DataFrame containing two columns,</span>
<span class="sd">        where the first column contains labels and</span>
<span class="sd">        the second column contains corresponding values</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - statistic : (float)</span>
<span class="sd">            The calculated F-statistic.</span>
<span class="sd">        - pvalue : (float)</span>
<span class="sd">            The associated p-value from the F distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input df must be pd.DataFrame&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input DataFrame must have exactly two columns&quot;</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value column must contain numeric values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;labels and values must not have missing values.</span><span class="se">\n</span><span class="s1">labels have </span><span class="si">{</span><span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values</span><span class="se">\n</span><span class="s1">values have </span><span class="si">{</span><span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_labels</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Labels must contain at least two unique values&quot;</span><span class="p">)</span>

    <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">label</span><span class="p">]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">unique_labels</span><span class="p">]</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">f_oneway</span><span class="p">(</span><span class="o">*</span><span class="n">samples</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Однофакторный ANOVA&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.anova_oneway_report" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">anova_oneway_report</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform ANOVA and generate a detailed report.</p>
<h6 id="pagri_data_tools.pagri_stats.anova_oneway_report--parameters">Parameters:</h6>
<p>df : pd.DataFrame
    The DataFrame containing the data for analysis.
category_column : str
    The name of the column in <code>df</code> that contains the group labels (categories).
    This column should have exactly two unique values representing the two groups to compare.
numeric_column : str
    The name of the column in <code>df</code> that contains the numeric values to compare between the two groups.
alpha : float, optional
    The significance level for the hypothesis tests. Default is 0.05.</p>
<h6 id="pagri_data_tools.pagri_stats.anova_oneway_report--returns">Returns:</h6>
<p>None</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3040</span>
<span class="normal">3041</span>
<span class="normal">3042</span>
<span class="normal">3043</span>
<span class="normal">3044</span>
<span class="normal">3045</span>
<span class="normal">3046</span>
<span class="normal">3047</span>
<span class="normal">3048</span>
<span class="normal">3049</span>
<span class="normal">3050</span>
<span class="normal">3051</span>
<span class="normal">3052</span>
<span class="normal">3053</span>
<span class="normal">3054</span>
<span class="normal">3055</span>
<span class="normal">3056</span>
<span class="normal">3057</span>
<span class="normal">3058</span>
<span class="normal">3059</span>
<span class="normal">3060</span>
<span class="normal">3061</span>
<span class="normal">3062</span>
<span class="normal">3063</span>
<span class="normal">3064</span>
<span class="normal">3065</span>
<span class="normal">3066</span>
<span class="normal">3067</span>
<span class="normal">3068</span>
<span class="normal">3069</span>
<span class="normal">3070</span>
<span class="normal">3071</span>
<span class="normal">3072</span>
<span class="normal">3073</span>
<span class="normal">3074</span>
<span class="normal">3075</span>
<span class="normal">3076</span>
<span class="normal">3077</span>
<span class="normal">3078</span>
<span class="normal">3079</span>
<span class="normal">3080</span>
<span class="normal">3081</span>
<span class="normal">3082</span>
<span class="normal">3083</span>
<span class="normal">3084</span>
<span class="normal">3085</span>
<span class="normal">3086</span>
<span class="normal">3087</span>
<span class="normal">3088</span>
<span class="normal">3089</span>
<span class="normal">3090</span>
<span class="normal">3091</span>
<span class="normal">3092</span>
<span class="normal">3093</span>
<span class="normal">3094</span>
<span class="normal">3095</span>
<span class="normal">3096</span>
<span class="normal">3097</span>
<span class="normal">3098</span>
<span class="normal">3099</span>
<span class="normal">3100</span>
<span class="normal">3101</span>
<span class="normal">3102</span>
<span class="normal">3103</span>
<span class="normal">3104</span>
<span class="normal">3105</span>
<span class="normal">3106</span>
<span class="normal">3107</span>
<span class="normal">3108</span>
<span class="normal">3109</span>
<span class="normal">3110</span>
<span class="normal">3111</span>
<span class="normal">3112</span>
<span class="normal">3113</span>
<span class="normal">3114</span>
<span class="normal">3115</span>
<span class="normal">3116</span>
<span class="normal">3117</span>
<span class="normal">3118</span>
<span class="normal">3119</span>
<span class="normal">3120</span>
<span class="normal">3121</span>
<span class="normal">3122</span>
<span class="normal">3123</span>
<span class="normal">3124</span>
<span class="normal">3125</span>
<span class="normal">3126</span>
<span class="normal">3127</span>
<span class="normal">3128</span>
<span class="normal">3129</span>
<span class="normal">3130</span>
<span class="normal">3131</span>
<span class="normal">3132</span>
<span class="normal">3133</span>
<span class="normal">3134</span>
<span class="normal">3135</span>
<span class="normal">3136</span>
<span class="normal">3137</span>
<span class="normal">3138</span>
<span class="normal">3139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">anova_oneway_report</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">category_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">numeric_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform ANOVA and generate a detailed report.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        The DataFrame containing the data for analysis.</span>
<span class="sd">    category_column : str</span>
<span class="sd">        The name of the column in `df` that contains the group labels (categories).</span>
<span class="sd">        This column should have exactly two unique values representing the two groups to compare.</span>
<span class="sd">    numeric_column : str</span>
<span class="sd">        The name of the column in `df` that contains the numeric values to compare between the two groups.</span>
<span class="sd">    alpha : float, optional</span>
<span class="sd">        The significance level for the hypothesis tests. Default is 0.05.</span>

<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check if the category column exists in the DataFrame</span>
    <span class="k">if</span> <span class="n">category_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">category_column</span><span class="si">}</span><span class="s2">&#39; not found in DataFrame.&quot;</span><span class="p">)</span>
    <span class="c1"># Check if the numeric column exists in the DataFrame</span>
    <span class="k">if</span> <span class="n">numeric_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">numeric_column</span><span class="si">}</span><span class="s2">&#39; not found in DataFrame.&quot;</span><span class="p">)</span>
    <span class="c1"># Ensure the numeric column contains numeric data</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numeric_column</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">numeric_column</span><span class="si">}</span><span class="s2">&#39; must contain numeric data.&quot;</span><span class="p">)</span>
    <span class="c1"># Verify that the category column contains exactly two unique groups</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">category_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">category_column</span><span class="si">}</span><span class="s2">&#39; must contain at least two unique groups.&quot;</span><span class="p">)</span>

    <span class="c1"># Remove missing values from the data</span>
    <span class="n">df_clean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Так как распределения средних близки к нормальным, то будем использовать параметрический тест.&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="c1"># State the null and alternative hypotheses</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 1: Формулировка гипотез.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H0: Средние значения во всех группах равны.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H1: Среднее значение хотя бы в одной группе отличается от других.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># State the null and alternative hypotheses for the Levene&#39;s test</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 2: Проверка равенства дисперсий.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H0: Дисперсии в группах равны.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H1: Дисперсии в группах не равны.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Используем тест Левена для проверки равенства дисперсий.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Уровень значимости (alpha) установлен на </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="c1"># Perform Levene&#39;s test to check for equal variances</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">p_value_levene</span> <span class="o">=</span> <span class="n">levene_df</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">equal_var</span> <span class="o">=</span> <span class="n">p_value_levene</span> <span class="o">&gt;=</span> <span class="n">alpha</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 3: Выбор подходящего теста ANOVA.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="c1"># Determine whether to use Welch&#39;s correction based on the Levene&#39;s test result</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">equal_var</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Так как дисперсии в группах разные, будем использовать Welch&#39;s ANOVA.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Так как нет оснований утверждать, что дисперсии в группах отличаются, используем стандартный ANOVA.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Уровень значимости alpha выберем </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="c1"># Check the sample size in each group</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 4: Проверка размеров групп.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="n">display</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[</span><span class="n">category_column</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">())</span>

    <span class="c1"># Perform test</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 5: Проведение теста.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">equal_var</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">p_value_anova</span> <span class="o">=</span> <span class="n">anova_oneway_df</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]]</span>
                        <span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span>
                        <span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">anova_results</span> <span class="o">=</span> <span class="n">anova_oneway_welch_df</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]]</span>
                        <span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span>
                        <span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">p_value_anova</span> <span class="o">=</span> <span class="n">anova_results</span><span class="p">[</span><span class="s1">&#39;p-unc&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">p_value_anova</span> <span class="o">&gt;=</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 6: Проведение post hoc теста.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">equal_var</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Так как нулевая гипотеза отвергнута, проведем тест Тьюки , чтобы обнаружить между какими группами есть различия.&#39;</span><span class="p">)</span>
            <span class="n">tukey_hsd_df</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Так как нулевая гипотеза отвергнута, проведем тест Геймса-Хоуэлла , чтобы обнаружить между какими группами есть различия.&#39;</span><span class="p">)</span>
            <span class="n">games_howell_df</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.anova_oneway_welch_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">anova_oneway_welch_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a one-way ANOVA test using Welch's ANOVA. It is more reliable when the two samples <br />
have unequal variances and/or unequal sample sizes.</p>
        <ul>
<li>df (pd.DataFrame): DataFrame containing two columns,
    where the first column contains labels and
    the second column contains corresponding values</li>
<li>alpha (float, optional): Significance level (default: 0.05)</li>
<li>return_results (bool, optional): Return (ANOVA summary) instead of printing (default=False).</li>
</ul>
<p>Returns:
- If return_results is False: None
- If return_results is True: (pandas.DataFrame) aov
        ANOVA summary:
        - 'Source': Factor names
        - 'SS': Sums of squares
        - 'DF': Degrees of freedom
        - 'MS': Mean squares
        - 'F': F-values
        - 'p-unc': uncorrected p-values
        - 'np2': Partial eta-squared</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">anova_oneway_welch_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a one-way ANOVA test using Welch&#39;s ANOVA. It is more reliable when the two samples   </span>
<span class="sd">    have unequal variances and/or unequal sample sizes.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - df (pd.DataFrame): DataFrame containing two columns,</span>
<span class="sd">        where the first column contains labels and</span>
<span class="sd">        the second column contains corresponding values</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - return_results (bool, optional): Return (ANOVA summary) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True: (pandas.DataFrame) aov</span>
<span class="sd">            ANOVA summary:</span>
<span class="sd">            - &#39;Source&#39;: Factor names</span>
<span class="sd">            - &#39;SS&#39;: Sums of squares</span>
<span class="sd">            - &#39;DF&#39;: Degrees of freedom</span>
<span class="sd">            - &#39;MS&#39;: Mean squares</span>
<span class="sd">            - &#39;F&#39;: F-values</span>
<span class="sd">            - &#39;p-unc&#39;: uncorrected p-values</span>
<span class="sd">            - &#39;np2&#39;: Partial eta-squared</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input df must be pd.DataFrame&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input DataFrame must have exactly two columns&quot;</span><span class="p">)</span>
    <span class="n">labels_column</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">value_column</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">labels_column</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">value_column</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value column must contain numeric values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;labels and values must not have missing values.</span><span class="se">\n</span><span class="s1">labels have </span><span class="si">{</span><span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values</span><span class="se">\n</span><span class="s1">values have </span><span class="si">{</span><span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_labels</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Labels must contain at least two unique values&quot;</span><span class="p">)</span>

    <span class="n">anova_results</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">welch_anova</span><span class="p">(</span>
        <span class="n">dv</span><span class="o">=</span><span class="n">value_column</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="n">labels_column</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
    <span class="n">p_value</span> <span class="o">=</span> <span class="n">anova_results</span><span class="p">[</span><span class="s1">&#39;p-unc&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Однофакторный Welch&#39;s ANOVA&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">anova_results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.bartlett" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bartlett</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a Bartlett's test. Bartlett's test is a statistical test used to check if the variances of multiple samples are equal.</p>
<p>Parameters:
- samples (list): List of pd.Series, where each pd.Series contains values. There must be at least two samples.
- alpha (float, optional): Significance level (default: 0.05)
- return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False)</p>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - statistic : (float)
        The calculated chi-squared statistic.
    - pvalue : (float)
        The associated p-value from the chi-squared distribution</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bartlett</span><span class="p">(</span><span class="n">samples</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a Bartlett&#39;s test. Bartlett&#39;s test is a statistical test used to check if the variances of multiple samples are equal.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - samples (list): List of pd.Series, where each pd.Series contains values. There must be at least two samples.</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False)</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - statistic : (float)</span>
<span class="sd">            The calculated chi-squared statistic.</span>
<span class="sd">        - pvalue : (float)</span>
<span class="sd">            The associated p-value from the chi-squared distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input samples must be a list of pd.Series&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All values in samples must be numeric&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All samples must have at least one value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must have at least two samples&quot;</span><span class="p">)</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">bartlett</span><span class="p">(</span><span class="o">*</span><span class="n">samples</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Тест Бартлетта&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.bartlett_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bartlett_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a Bartlett's test. Bartlett's test is a statistical test used to check if the variances of multiple samples are equal.</p>
        <ul>
<li>df (pd.DataFrame): DataFrame containing two columns,
    where the first column contains labels and
    the second column contains corresponding values</li>
<li>alpha (float, optional): Significance level (default: 0.05)</li>
<li>return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False).</li>
</ul>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - statistic : (float)
        The calculated chi-squared statistic.
    - pvalue : (float)
        The associated p-value from the chi-squared distribution</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bartlett_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a Bartlett&#39;s test. Bartlett&#39;s test is a statistical test used to check if the variances of multiple samples are equal.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - df (pd.DataFrame): DataFrame containing two columns,</span>
<span class="sd">        where the first column contains labels and</span>
<span class="sd">        the second column contains corresponding values</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - statistic : (float)</span>
<span class="sd">            The calculated chi-squared statistic.</span>
<span class="sd">        - pvalue : (float)</span>
<span class="sd">            The associated p-value from the chi-squared distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input df must be pd.DataFrame&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input DataFrame must have exactly two columns&quot;</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value column must contain numeric values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;labels and values must not have missing values.</span><span class="se">\n</span><span class="s1">labels have </span><span class="si">{</span><span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values</span><span class="se">\n</span><span class="s1">values have </span><span class="si">{</span><span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_labels</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Labels must contain at least two unique values&quot;</span><span class="p">)</span>

    <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">label</span><span class="p">]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">unique_labels</span><span class="p">]</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">bartlett</span><span class="p">(</span><span class="o">*</span><span class="n">samples</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Тест Бартлетта&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.bootstrap_diff_2sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bootstrap_diff_2sample</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">,</span> <span class="n">stat_func</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">bootstrap_conf_level</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">num_boot</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">p_value_method</span><span class="o">=</span><span class="s1">&#39;normal_approx&#39;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_boot_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_tqdm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform bootstrap resampling to estimate the difference of a statistic between two samples.</p>
<p>Parameters:
- sample1, sample2: pd.Series, two samples to compare
- stat_func: callable, statistical function to apply to each bootstrap sample (default: np.mean)
- bootstrap_conf_level: float, significance level for confidence interval (must be between 0 and 1 inclusive) (default: 0.95)
- num_boot: int, number of bootstrap iterations (default: 10000)
- alpha (float, optional): Significance level (default: 0.05)
- p_value_method: str, method for calculating the p-value (default: 'normal_approx', options: 'normal_approx', 'kde')
- plot: bool, whether to show the plot of the bootstrap distribution (default: True)
- return_boot_data: bool, whether to return the bootstrap data (default: False)
- return_results (bool, optional): Return (chi2, p_value, dof, expected) instead of printing (default=False).</p>
        <ul>
<li>If return_results is True<ul>
<li>If return_boot_data is False: ci: tuple, confidence interval for the difference in means, p_value: float, p-value for the null hypothesis that the means are equal</li>
<li>If return_boot_data is True: boot_data: list, bootstrap estimates of the difference in means, ci: tuple, confidence interval for the difference in means, p_value: float, p-value for the null hypothesis that the means are equal</li>
<li>If plot is True: additionaly return plotly fig object 
Default (ci, p_value, fig)</li>
</ul>
</li>
<li>Else None</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bootstrap_diff_2sample</span><span class="p">(</span><span class="n">sample1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">sample2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
                           <span class="n">stat_func</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
                           <span class="n">bootstrap_conf_level</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
                           <span class="n">num_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
                           <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
                           <span class="n">p_value_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;normal_approx&#39;</span><span class="p">,</span>
                           <span class="n">plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                           <span class="n">return_boot_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                           <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                           <span class="n">with_tqdm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform bootstrap resampling to estimate the difference of a statistic between two samples.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - sample1, sample2: pd.Series, two samples to compare</span>
<span class="sd">    - stat_func: callable, statistical function to apply to each bootstrap sample (default: np.mean)</span>
<span class="sd">    - bootstrap_conf_level: float, significance level for confidence interval (must be between 0 and 1 inclusive) (default: 0.95)</span>
<span class="sd">    - num_boot: int, number of bootstrap iterations (default: 10000)</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - p_value_method: str, method for calculating the p-value (default: &#39;normal_approx&#39;, options: &#39;normal_approx&#39;, &#39;kde&#39;)</span>
<span class="sd">    - plot: bool, whether to show the plot of the bootstrap distribution (default: True)</span>
<span class="sd">    - return_boot_data: bool, whether to return the bootstrap data (default: False)</span>
<span class="sd">    - return_results (bool, optional): Return (chi2, p_value, dof, expected) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - If return_boot_data is False: ci: tuple, confidence interval for the difference in means, p_value: float, p-value for the null hypothesis that the means are equal</span>
<span class="sd">        - If return_boot_data is True: boot_data: list, bootstrap estimates of the difference in means, ci: tuple, confidence interval for the difference in means, p_value: float, p-value for the null hypothesis that the means are equal</span>
<span class="sd">        - If plot is True: additionaly return plotly fig object </span>
<span class="sd">        Default (ci, p_value, fig)</span>
<span class="sd">    - Else None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">human_readable_number</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mf">1e6</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mf">1e6</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">M&quot;</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mf">1e3</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mf">1e3</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">k&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_data</span><span class="p">(</span><span class="n">boot_data</span><span class="p">):</span>
        <span class="c1"># Create bins and histogram values using NumPy</span>

        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">boot_data</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">boot_data</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">30</span><span class="p">)</span>
        <span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">boot_data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">human_readable_number</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">human_readable_number</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>

        <span class="c1"># Create a Plotly figure with the histogram values and bin edges</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">hist</span><span class="p">,</span>
                     <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Бутстреп-распределение разницы&quot;</span><span class="p">)</span>

        <span class="c1"># Color the bars outside the CI orange</span>
        <span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">ci</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#049CB3&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">ci_lower</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&gt;</span>
                  <span class="n">ci_upper</span> <span class="k">else</span> <span class="s1">&#39;rgba(128, 60, 170, 0.9)&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bins</span><span class="p">]</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">colors</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_vline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ci_lower</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;#049CB3&quot;</span><span class="p">,</span>
                      <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">annotation_position</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span> <span class="n">annotation_font_color</span><span class="o">=</span><span class="s1">&#39;#049CB3&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_vline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ci_upper</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;#049CB3&quot;</span><span class="p">,</span>
                      <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">annotation_position</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span> <span class="n">annotation_font_color</span><span class="o">=</span><span class="s1">&#39;#049CB3&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_annotations</span><span class="p">(</span><span class="n">font_size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
            <span class="n">hovertemplate</span><span class="o">=</span><span class="s1">&#39;Количество = %</span><span class="si">{y}</span><span class="s1">&lt;br&gt;Разница = %</span><span class="si">{text}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="c1"># Remove gap between bars and show white line</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
            <span class="n">bargap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;Разница&quot;</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Количество&quot;</span><span class="p">,</span>
            <span class="n">title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">),</span>
            <span class="n">title</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fig</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">},</span>
            <span class="c1"># Для подписей и меток</span>
            <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s2">&quot;Open Sans&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 1)&quot;</span><span class="p">),</span>
            <span class="n">xaxis_title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">),</span>
            <span class="n">yaxis_title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">),</span>
            <span class="n">xaxis_tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">),</span>
            <span class="n">yaxis_tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">),</span>
            <span class="n">xaxis_linecolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">,</span>
            <span class="c1"># xaxis_linewidth=2,</span>
            <span class="n">yaxis_linecolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">,</span>
            <span class="c1"># yaxis_linewidth=2</span>
            <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">70</span><span class="p">),</span>
            <span class="n">hoverlabel</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Show the plot</span>
        <span class="k">return</span> <span class="n">fig</span>

    <span class="c1"># Check input types and lengths</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample2</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input samples must be pd.Series&quot;</span><span class="p">)</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="c1"># Bootstrap Sampling</span>
    <span class="n">boot_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_boot</span><span class="p">)</span>
    <span class="n">max_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample2</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">with_tqdm</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_boot</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Bootstrapping&quot;</span><span class="p">):</span>
            <span class="n">samples_1</span> <span class="o">=</span> <span class="n">sample1</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">max_len</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
            <span class="n">samples_2</span> <span class="o">=</span> <span class="n">sample2</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">max_len</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
            <span class="n">boot_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">stat_func</span><span class="p">(</span><span class="n">samples_1</span><span class="p">)</span> <span class="o">-</span> <span class="n">stat_func</span><span class="p">(</span><span class="n">samples_2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boot</span><span class="p">):</span>
            <span class="n">samples_1</span> <span class="o">=</span> <span class="n">sample1</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">max_len</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
            <span class="n">samples_2</span> <span class="o">=</span> <span class="n">sample2</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">max_len</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
            <span class="n">boot_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">stat_func</span><span class="p">(</span><span class="n">samples_1</span><span class="p">)</span> <span class="o">-</span> <span class="n">stat_func</span><span class="p">(</span><span class="n">samples_2</span><span class="p">)</span>        

    <span class="c1"># Confidence Interval Calculation</span>
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">bootstrap_conf_level</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">lower_bound</span>
    <span class="n">ci</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span>
        <span class="n">boot_data</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span> <span class="o">*</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">upper_bound</span><span class="p">]))</span>

    <span class="c1"># P-value Calculation</span>
    <span class="k">if</span> <span class="n">p_value_method</span> <span class="o">==</span> <span class="s1">&#39;normal_approx&#39;</span><span class="p">:</span>
        <span class="n">p_value</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span>
            <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">boot_data</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">boot_data</span><span class="p">)),</span>
            <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">boot_data</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">boot_data</span><span class="p">))</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">p_value_method</span> <span class="o">==</span> <span class="s1">&#39;kde&#39;</span><span class="p">:</span>
        <span class="n">kde</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">boot_data</span><span class="p">)</span>
        <span class="n">p_value</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">kde</span><span class="o">.</span><span class="n">integrate_box_1d</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                          <span class="n">kde</span><span class="o">.</span><span class="n">integrate_box_1d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid p_value_method. Must be &#39;normal_approx&#39; or &#39;kde&#39;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Bootstrap resampling to estimate the difference&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ci = &#39;</span><span class="p">,</span> <span class="n">ci</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
                <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
                <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">plot_data</span><span class="p">(</span><span class="n">boot_data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">return_boot_data</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">boot_data</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">p_value</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">ci</span><span class="p">,</span> <span class="n">p_value</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plot_data</span><span class="p">(</span><span class="n">boot_data</span><span class="p">))</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.bootstrap_single_sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bootstrap_single_sample</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">stat_func</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">bootstrap_conf_level</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">num_boot</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_boot_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_tqdm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform bootstrap resampling to estimate the variability of a statistic for a single sample.</p>
<p>Parameters:
- sample1, sample2: pd.Series, two samples to compare
- stat_func: callable, statistical function to apply to each bootstrap sample (default: np.mean)
- bootstrap_conf_level: float, significance level for confidence interval (must be between 0 and 1 inclusive) (default: 0.95)
- num_boot: int, number of bootstrap iterations (default: 1000)
- plot: bool, whether to show the plot of the bootstrap distribution (default: True)
- return_boot_data: bool, whether to return the bootstrap data (default: False)
- return_results (bool, optional): Return (chi2, p_value, dof, expected) instead of printing (default=False).</p>
        <ul>
<li>If return_results is True<ul>
<li>If return_boot_data is False: ci: tuple, confidence interval for the difference in means</li>
<li>If return_boot_data is True: boot_data: list, bootstrap estimates of the difference in means, ci: tuple, confidence interval for the difference in means</li>
<li>If plot is True: additionaly return plotly fig object 
Default (ci, p_value, fig)</li>
</ul>
</li>
<li>Else None</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span>
<span class="normal">2630</span>
<span class="normal">2631</span>
<span class="normal">2632</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bootstrap_single_sample</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
                            <span class="n">stat_func</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
                            <span class="n">bootstrap_conf_level</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
                            <span class="n">num_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
                            <span class="n">plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                            <span class="n">return_boot_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="n">with_tqdm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform bootstrap resampling to estimate the variability of a statistic for a single sample.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - sample1, sample2: pd.Series, two samples to compare</span>
<span class="sd">    - stat_func: callable, statistical function to apply to each bootstrap sample (default: np.mean)</span>
<span class="sd">    - bootstrap_conf_level: float, significance level for confidence interval (must be between 0 and 1 inclusive) (default: 0.95)</span>
<span class="sd">    - num_boot: int, number of bootstrap iterations (default: 1000)</span>
<span class="sd">    - plot: bool, whether to show the plot of the bootstrap distribution (default: True)</span>
<span class="sd">    - return_boot_data: bool, whether to return the bootstrap data (default: False)</span>
<span class="sd">    - return_results (bool, optional): Return (chi2, p_value, dof, expected) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - If return_boot_data is False: ci: tuple, confidence interval for the difference in means</span>
<span class="sd">        - If return_boot_data is True: boot_data: list, bootstrap estimates of the difference in means, ci: tuple, confidence interval for the difference in means</span>
<span class="sd">        - If plot is True: additionaly return plotly fig object </span>
<span class="sd">        Default (ci, p_value, fig)</span>
<span class="sd">    - Else None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">human_readable_number</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mf">1e6</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mf">1e6</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="o">/</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">M&quot;</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mf">1e3</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mf">1e3</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="o">/</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">k&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_data</span><span class="p">(</span><span class="n">boot_data</span><span class="p">):</span>
        <span class="c1"># Create bins and histogram values using NumPy</span>

        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">boot_data</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">boot_data</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">30</span><span class="p">)</span>
        <span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">boot_data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">human_readable_number</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">human_readable_number</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>

        <span class="c1"># Create a Plotly figure with the histogram values and bin edges</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">hist</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Bootstrap Distribution&quot;</span><span class="p">)</span>

        <span class="c1"># Color the bars outside the CI orange</span>
        <span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">ci</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#049CB3&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">ci_lower</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&gt;</span>
                  <span class="n">ci_upper</span> <span class="k">else</span> <span class="s1">&#39;rgba(128, 60, 170, 0.9)&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bins</span><span class="p">]</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">colors</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_vline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ci_lower</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;#049CB3&quot;</span><span class="p">,</span>
                      <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;CI Lower: </span><span class="si">{</span><span class="n">ci_lower</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_vline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ci_upper</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;#049CB3&quot;</span><span class="p">,</span>
                      <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;CI Upper: </span><span class="si">{</span><span class="n">ci_upper</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_annotations</span><span class="p">(</span><span class="n">font_size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
            <span class="n">hovertemplate</span><span class="o">=</span><span class="s1">&#39;count=%</span><span class="si">{y}</span><span class="s1">&lt;br&gt;x=%</span><span class="si">{text}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="c1"># Remove gap between bars and show white line</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
            <span class="n">bargap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span>
            <span class="n">title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.6)&quot;</span><span class="p">),</span>
            <span class="n">title</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;&lt;b&gt;</span><span class="si">{</span><span class="n">fig</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s1">&lt;/b&gt;&#39;</span><span class="p">},</span>
            <span class="c1"># Для подписей и меток</span>
            <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s2">&quot;Open Sans&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 1)&quot;</span><span class="p">),</span>
            <span class="n">xaxis_title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">),</span>
            <span class="n">yaxis_title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">),</span>
            <span class="n">xaxis_tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">),</span>
            <span class="n">yaxis_tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">),</span>
            <span class="n">xaxis_linecolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">,</span>
            <span class="c1"># xaxis_linewidth=2,</span>
            <span class="n">yaxis_linecolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">,</span>
            <span class="c1"># yaxis_linewidth=2</span>
            <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">70</span><span class="p">),</span>
            <span class="n">hoverlabel</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Show the plot</span>
        <span class="k">return</span> <span class="n">fig</span>

    <span class="c1"># Check input types and lengths</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input sample must be pd.Series&quot;</span><span class="p">)</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
        <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="c1"># Bootstrap Sampling</span>
    <span class="n">boot_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_boot</span><span class="p">)</span>
    <span class="n">max_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">with_tqdm</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_boot</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Bootstrapping&quot;</span><span class="p">):</span>
            <span class="n">samples_1</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">max_len</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
            <span class="n">boot_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">stat_func</span><span class="p">(</span><span class="n">samples_1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boot</span><span class="p">):</span>
            <span class="n">samples_1</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">max_len</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
            <span class="n">boot_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">stat_func</span><span class="p">(</span><span class="n">samples_1</span><span class="p">)</span>        
    <span class="c1"># Confidence Interval Calculation</span>
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">bootstrap_conf_level</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">lower_bound</span>
    <span class="n">ci</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span>
        <span class="n">boot_data</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span> <span class="o">*</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">upper_bound</span><span class="p">]))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Bootstrap resampling&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ci = &#39;</span><span class="p">,</span> <span class="n">ci</span><span class="p">)</span>
        <span class="n">plot_data</span><span class="p">(</span><span class="n">boot_data</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">return_boot_data</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">boot_data</span><span class="p">,</span> <span class="n">ci</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">ci</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plot_data</span><span class="p">(</span><span class="n">boot_data</span><span class="p">))</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.calculate_cohens_d" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_cohens_d</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate Cohen's d from two independent samples.<br />
Cohen's d is a measure of effect size used to quantify the standardized difference between the means of two groups.</p>
<p>Parameters:
sample1 (pd.Series): First sample
sample2 (pd.Series): Second sample
equal_var (bool): Whether to assume equal variances between the two samples. If <code>True</code>, the pooled standard deviation is used. <br />
If <code>False</code>, the standard error is calculated using the separate variances of each sample. Defaults to <code>False</code>.</p>
<p>Returns:
float: Cohen's d</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_cohens_d</span><span class="p">(</span><span class="n">sample1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">sample2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate Cohen&#39;s d from two independent samples.  </span>
<span class="sd">    Cohen&#39;s d is a measure of effect size used to quantify the standardized difference between the means of two groups.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    sample1 (pd.Series): First sample</span>
<span class="sd">    sample2 (pd.Series): Second sample</span>
<span class="sd">    equal_var (bool): Whether to assume equal variances between the two samples. If `True`, the pooled standard deviation is used.   </span>
<span class="sd">    If `False`, the standard error is calculated using the separate variances of each sample. Defaults to `False`.</span>

<span class="sd">    Returns:</span>
<span class="sd">    float: Cohen&#39;s d</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if inputs are pd.Series</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample2</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Both inputs must be pd.Series&quot;</span><span class="p">)</span>

    <span class="c1"># Check if samples are not empty</span>
    <span class="k">if</span> <span class="n">sample1</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="n">sample2</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Both samples must be non-empty&quot;</span><span class="p">)</span>

    <span class="c1"># Calculate means and variances</span>
    <span class="n">mean1</span><span class="p">,</span> <span class="n">var1</span> <span class="o">=</span> <span class="n">sample1</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">sample1</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">mean2</span><span class="p">,</span> <span class="n">var2</span> <span class="o">=</span> <span class="n">sample2</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">sample2</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Calculate sample sizes</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">equal_var</span><span class="p">:</span>
        <span class="c1"># Calculate pooled standard deviation</span>
        <span class="n">pooled_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="p">((</span><span class="n">n1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">+</span> <span class="p">(</span><span class="n">n2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">var2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">cohens_d</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span><span class="p">)</span> <span class="o">/</span> <span class="n">pooled_std</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">varn1</span> <span class="o">=</span> <span class="n">var1</span> <span class="o">/</span> <span class="n">n1</span>
        <span class="n">varn2</span> <span class="o">=</span> <span class="n">var2</span> <span class="o">/</span> <span class="n">n2</span>
        <span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">varn1</span> <span class="o">+</span> <span class="n">varn2</span><span class="p">)</span>
        <span class="n">cohens_d</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span><span class="p">)</span> <span class="o">/</span> <span class="n">standard_error</span>

    <span class="k">return</span> <span class="n">cohens_d</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.chi2_pearson" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">chi2_pearson</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform Pearson's chi-squared test for independence between two categorical variables.</p>
<p>Parameters:
- column1 (pd.Series): First categorical variable
- column2 (pd.Series): Second categorical variable
- alpha (float, optional): Significance level (default: 0.05)
- return_results (bool, optional): Return (chi2, p_value, dof, expected) instead of printing (default=False).</p>
<p>Returns:
- If return_results is False: 
None
- If return_results is True
    - chi2 : (float) 
        The test statistic.
    - p : (float) 
        The p-value of the test
    - dof : (int)
        Degrees of freedom
    - expected : (ndarray, same shape as observed)
        The expected frequencies, based on the marginal sums of the table.</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">chi2_pearson</span><span class="p">(</span><span class="n">sample1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">sample2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform Pearson&#39;s chi-squared test for independence between two categorical variables.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - column1 (pd.Series): First categorical variable</span>
<span class="sd">    - column2 (pd.Series): Second categorical variable</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - return_results (bool, optional): Return (chi2, p_value, dof, expected) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: </span>
<span class="sd">    None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - chi2 : (float) </span>
<span class="sd">            The test statistic.</span>
<span class="sd">        - p : (float) </span>
<span class="sd">            The p-value of the test</span>
<span class="sd">        - dof : (int)</span>
<span class="sd">            Degrees of freedom</span>
<span class="sd">        - expected : (ndarray, same shape as observed)</span>
<span class="sd">            The expected frequencies, based on the marginal sums of the table.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input samples must be pd.Series&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All samples must have at least one value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sample1</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">sample2</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;column1 and column2 must not have missing values.</span><span class="se">\n</span><span class="s1">column1 have </span><span class="si">{</span><span class="n">sample1</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values</span><span class="se">\n</span><span class="s1">column2 have </span><span class="si">{</span><span class="n">sample2</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="n">crosstab_for_chi2_pearson</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">)</span>
    <span class="n">chi2</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2_contingency</span><span class="p">(</span>
        <span class="n">crosstab_for_chi2_pearson</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Хи-квадрат Пирсона&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.chisquare" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">chisquare</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate a one-way chi-square test.
Perform Pearson's chi-squared test for the null hypothesis that the categorical data has the given frequencies.</p>
<p>Parameters:
- sample(pd.Series): First categorical variable
- alpha (float, optional): Significance level (default: 0.05)
- return_results (bool, optional): Return (chi2, p_value, dof, expected) instead of printing (default=False).</p>
<p>Returns:
- If return_results is False: 
None
- If return_results is True
    - chi2 : (float) 
        The test statistic.
    - p : (float) 
        The p-value of the test
    - dof : (int)
        Degrees of freedom
    - expected : (ndarray, same shape as observed)
        The expected frequencies, based on the marginal sums of the table.</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">chisquare</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate a one-way chi-square test.</span>
<span class="sd">    Perform Pearson&#39;s chi-squared test for the null hypothesis that the categorical data has the given frequencies.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - sample(pd.Series): First categorical variable</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - return_results (bool, optional): Return (chi2, p_value, dof, expected) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: </span>
<span class="sd">    None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - chi2 : (float) </span>
<span class="sd">            The test statistic.</span>
<span class="sd">        - p : (float) </span>
<span class="sd">            The p-value of the test</span>
<span class="sd">        - dof : (int)</span>
<span class="sd">            Degrees of freedom</span>
<span class="sd">        - expected : (ndarray, same shape as observed)</span>
<span class="sd">            The expected frequencies, based on the marginal sums of the table.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input samples must be pd.Series&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All samples must have at least one value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sample</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;column1 and column2 must not have missing values.</span><span class="se">\n</span><span class="s1">column1 have </span><span class="si">{</span><span class="n">sample</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>

    <span class="n">chi2</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Хи-квадрат Пирсона&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.confint_proportion_2sample_statsmodels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">confint_proportion_2sample_statsmodels</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">nobs1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">nobs2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the confidence interval for the difference of two proportions only 'two-sided' alternative.</p>
<p>Parameters:
- count1: int, number of successes (1s) in the first sample
- nobs1: int, total number of observations in the first sample
- count2: int, number of successes (1s) in the second sample
- nobs2: int, total number of observations in the second sample
- alpha : float (default=0.05).
    Significance level for the confidence interval, coverage is
    <code>1-alpha</code>.</p>
<h6 id="pagri_data_tools.pagri_stats.confint_proportion_2sample_statsmodels--returns">Returns</h6>
<ul>
<li>ci: tuple, confidence interval (lower, upper)<ul>
<li>lower : float
    Lower confidence limit. This is -inf for the one-sided alternative
    "smaller".</li>
<li>upper : float
    Upper confidence limit. This is inf for the one-sided alternative
    "larger".</li>
</ul>
</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">confint_proportion_2sample_statsmodels</span><span class="p">(</span><span class="n">count1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nobs1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">count2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nobs2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the confidence interval for the difference of two proportions only &#39;two-sided&#39; alternative.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - count1: int, number of successes (1s) in the first sample</span>
<span class="sd">    - nobs1: int, total number of observations in the first sample</span>
<span class="sd">    - count2: int, number of successes (1s) in the second sample</span>
<span class="sd">    - nobs2: int, total number of observations in the second sample</span>
<span class="sd">    - alpha : float (default=0.05).</span>
<span class="sd">        Significance level for the confidence interval, coverage is</span>
<span class="sd">        ``1-alpha``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - ci: tuple, confidence interval (lower, upper)</span>
<span class="sd">        - lower : float</span>
<span class="sd">            Lower confidence limit. This is -inf for the one-sided alternative</span>
<span class="sd">            &quot;smaller&quot;.</span>
<span class="sd">        - upper : float</span>
<span class="sd">            Upper confidence limit. This is inf for the one-sided alternative</span>
<span class="sd">            &quot;larger&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Additional checks</span>
    <span class="k">if</span> <span class="n">nobs1</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">nobs2</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Each sample (nobs1 and nobs2) must have at least two observations&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count1</span> <span class="o">&gt;</span> <span class="n">nobs1</span> <span class="ow">or</span> <span class="n">count2</span> <span class="o">&gt;</span> <span class="n">nobs2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Count cannot be greater than sample size&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">nobs1</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">or</span> <span class="n">nobs2</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>

    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">confint_proportions_2indep</span><span class="p">(</span>
        <span class="n">count1</span><span class="o">=</span><span class="n">count1</span><span class="p">,</span> <span class="n">nobs1</span><span class="o">=</span><span class="n">nobs1</span><span class="p">,</span> <span class="n">count2</span><span class="o">=</span><span class="n">count2</span><span class="p">,</span> <span class="n">nobs2</span><span class="o">=</span><span class="n">nobs2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.confint_proportion_coluns_2sample_statsmodels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">confint_proportion_coluns_2sample_statsmodels</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the confidence interval for the difference of two proportions only 'two-sided' alternative.</p>
<p>Parameters:
- column: pd.Series, input column with two unique values
- alpha : float (default=0.05).
    Significance level for the confidence interval, coverage is
    <code>1-alpha</code>.</p>
<h6 id="pagri_data_tools.pagri_stats.confint_proportion_coluns_2sample_statsmodels--returns">Returns</h6>
<ul>
<li>ci: tuple, confidence interval (lower, upper)<ul>
<li>lower : float
    Lower confidence limit. This is -inf for the one-sided alternative
    "smaller".</li>
<li>upper : float
    Upper confidence limit. This is inf for the one-sided alternative
    "larger".</li>
</ul>
</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">confint_proportion_coluns_2sample_statsmodels</span><span class="p">(</span><span class="n">column</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the confidence interval for the difference of two proportions only &#39;two-sided&#39; alternative.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - column: pd.Series, input column with two unique values</span>
<span class="sd">    - alpha : float (default=0.05).</span>
<span class="sd">        Significance level for the confidence interval, coverage is</span>
<span class="sd">        ``1-alpha``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - ci: tuple, confidence interval (lower, upper)</span>
<span class="sd">        - lower : float</span>
<span class="sd">            Lower confidence limit. This is -inf for the one-sided alternative</span>
<span class="sd">            &quot;smaller&quot;.</span>
<span class="sd">        - upper : float</span>
<span class="sd">            Upper confidence limit. This is inf for the one-sided alternative</span>
<span class="sd">            &quot;larger&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Validate input column</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input column must be pd.Series&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input column must have at least one value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;column must not have missing values.</span><span class="se">\n</span><span class="s1">column have </span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;column must have exactly two unique values.</span><span class="se">\n</span><span class="s1">column have </span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s1"> unique values&#39;</span><span class="p">)</span>

    <span class="n">value_counts</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">count1</span> <span class="o">=</span> <span class="n">value_counts</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">count2</span> <span class="o">=</span> <span class="n">value_counts</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">nobs1</span> <span class="o">=</span> <span class="n">nobs2</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">size</span>
    <span class="c1"># Additional checks</span>
    <span class="k">if</span> <span class="n">nobs1</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">nobs2</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Each sample (nobs1 and nobs2) must have at least two observations&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count1</span> <span class="o">&gt;</span> <span class="n">nobs1</span> <span class="ow">or</span> <span class="n">count2</span> <span class="o">&gt;</span> <span class="n">nobs2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Count cannot be greater than sample size&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">nobs1</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">or</span> <span class="n">nobs2</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>

    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">confint_proportions_2indep</span><span class="p">(</span>
        <span class="n">count1</span><span class="o">=</span><span class="n">count1</span><span class="p">,</span> <span class="n">nobs1</span><span class="o">=</span><span class="n">nobs1</span><span class="p">,</span> <span class="n">count2</span><span class="o">=</span><span class="n">count2</span><span class="p">,</span> <span class="n">nobs2</span><span class="o">=</span><span class="n">nobs2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.confint_proportion_ztest_1sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">confint_proportion_ztest_1sample</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">nobs</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the confidence interval for a proportion in one sample.</p>
<p>Parameters:
- count: int, number of successes (1s) in the sample
- nobs: int, total number of observations in the sample
- alpha : float (default=0.05).
    Significance level for the confidence interval, coverage is
    <code>1-alpha</code>.
- alternative : (str, optional) (default='two-sided').
    The alternative hypothesis, H1, has to be one of the following</p>
<div class="highlight"><pre><span></span><code>   * &#39;two-sided&#39; : H1: ``p - p0`` not equal to 0.
   * &#39;larger&#39; :   H1: ``p - p0 &gt; 0``
   * &#39;smaller&#39; :  H1: ``p - p0 &lt; 0``
</code></pre></div>
<h6 id="pagri_data_tools.pagri_stats.confint_proportion_ztest_1sample--returns">Returns</h6>
<ul>
<li>ci: tuple, confidence interval (lower, upper)<ul>
<li>lower : float
    Lower confidence limit. This is -inf for the one-sided alternative
    "smaller".</li>
<li>upper : float
    Upper confidence limit. This is inf for the one-sided alternative
    "larger".</li>
</ul>
</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">confint_proportion_ztest_1sample</span><span class="p">(</span><span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nobs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the confidence interval for a proportion in one sample.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - count: int, number of successes (1s) in the sample</span>
<span class="sd">    - nobs: int, total number of observations in the sample</span>
<span class="sd">    - alpha : float (default=0.05).</span>
<span class="sd">        Significance level for the confidence interval, coverage is</span>
<span class="sd">        ``1-alpha``.</span>
<span class="sd">    - alternative : (str, optional) (default=&#39;two-sided&#39;).</span>
<span class="sd">        The alternative hypothesis, H1, has to be one of the following</span>

<span class="sd">           * &#39;two-sided&#39; : H1: ``p - p0`` not equal to 0.</span>
<span class="sd">           * &#39;larger&#39; :   H1: ``p - p0 &gt; 0``</span>
<span class="sd">           * &#39;smaller&#39; :  H1: ``p - p0 &lt; 0``</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - ci: tuple, confidence interval (lower, upper)</span>
<span class="sd">        - lower : float</span>
<span class="sd">            Lower confidence limit. This is -inf for the one-sided alternative</span>
<span class="sd">            &quot;smaller&quot;.</span>
<span class="sd">        - upper : float</span>
<span class="sd">            Upper confidence limit. This is inf for the one-sided alternative</span>
<span class="sd">            &quot;larger&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Additional checks</span>
    <span class="k">if</span> <span class="n">nobs</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sample (nobs) must have at least two observations&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">nobs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Count cannot be greater than sample size&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">nobs</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="c1"># Calculate proportion</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="n">nobs</span>

    <span class="c1"># Calculate standard error</span>
    <span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">/</span> <span class="n">nobs</span><span class="p">)</span>

    <span class="c1"># Calculate critical value and confidence interval bounds</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">]:</span>
        <span class="n">zcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">]:</span>
        <span class="n">zcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="n">zcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>

    <span class="k">return</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.confint_proportion_ztest_1sample_column" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">confint_proportion_ztest_1sample_column</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the confidence interval for a proportion in one sample containing 0 or 1.</p>
<p>Parameters:
- sample: Pandas Series object containing 0 or 1
- alpha : float (default=0.05).
    Significance level for the confidence interval, coverage is
    <code>1-alpha</code>.
- alternative : (str, optional) (default='two-sided').
    The alternative hypothesis, H1, has to be one of the following</p>
<div class="highlight"><pre><span></span><code>   * &#39;two-sided&#39; : H1: ``p - p0`` not equal to 0.
   * &#39;larger&#39; :   H1: ``p - p0 &gt; 0``
   * &#39;smaller&#39; :  H1: ``p - p0 &lt; 0``
</code></pre></div>
<h6 id="pagri_data_tools.pagri_stats.confint_proportion_ztest_1sample_column--returns">Returns</h6>
<ul>
<li>ci: tuple, confidence interval (lower, upper)<ul>
<li>lower : float
    Lower confidence limit. This is -inf for the one-sided alternative
    "smaller".</li>
<li>upper : float
    Upper confidence limit. This is inf for the one-sided alternative
    "larger".</li>
</ul>
</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">confint_proportion_ztest_1sample_column</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the confidence interval for a proportion in one sample containing 0 or 1.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - sample: Pandas Series object containing 0 or 1</span>
<span class="sd">    - alpha : float (default=0.05).</span>
<span class="sd">        Significance level for the confidence interval, coverage is</span>
<span class="sd">        ``1-alpha``.</span>
<span class="sd">    - alternative : (str, optional) (default=&#39;two-sided&#39;).</span>
<span class="sd">        The alternative hypothesis, H1, has to be one of the following</span>

<span class="sd">           * &#39;two-sided&#39; : H1: ``p - p0`` not equal to 0.</span>
<span class="sd">           * &#39;larger&#39; :   H1: ``p - p0 &gt; 0``</span>
<span class="sd">           * &#39;smaller&#39; :  H1: ``p - p0 &lt; 0``</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - ci: tuple, confidence interval (lower, upper)</span>
<span class="sd">        - lower : float</span>
<span class="sd">            Lower confidence limit. This is -inf for the one-sided alternative</span>
<span class="sd">            &quot;smaller&quot;.</span>
<span class="sd">        - upper : float</span>
<span class="sd">            Upper confidence limit. This is inf for the one-sided alternative</span>
<span class="sd">            &quot;larger&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="c1"># Check if sample contains only 0 and 1</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">sample</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">sample</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sample must contain only 0 and 1&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Check if sample is Pandas Series object</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sample must be Pandas Series object&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sample must have at least two elements&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="c1"># Calculate proportion</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># Calculate standard error</span>
    <span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span>

    <span class="c1"># Calculate critical value and confidence interval bounds</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">]:</span>
        <span class="n">zcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">]:</span>
        <span class="n">zcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="n">zcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>

    <span class="k">return</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.confint_proportion_ztest_2sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">confint_proportion_ztest_2sample</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">nobs1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">nobs2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the confidence interval using normal distribution for the difference of two proportions.</p>
<p>Parameters:
- count1: int, number of successes (1s) in the first sample
- nobs1: int, total number of observations in the first sample
- count2: int, number of successes (1s) in the second sample
- nobs2: int, total number of observations in the second sample
- alpha : float (default=0.05).
    Significance level for the confidence interval, coverage is
    <code>1-alpha</code>.
- alternative : (str, optional) (default='two-sided').
    The alternative hypothesis, H1, has to be one of the following</p>
<div class="highlight"><pre><span></span><code>   * &#39;two-sided&#39; : H1: ``p1 - p2`` not equal to 0.
   * &#39;larger&#39; :   H1: ``p1 - p2 &gt; 0``
   * &#39;smaller&#39; :  H1: ``p1 - p2 &lt; 0``
</code></pre></div>
<h6 id="pagri_data_tools.pagri_stats.confint_proportion_ztest_2sample--returns">Returns</h6>
<ul>
<li>ci: tuple, confidence interval (lower, upper)<ul>
<li>lower : float
    Lower confidence limit. This is -inf for the one-sided alternative
    "smaller".</li>
<li>upper : float
    Upper confidence limit. This is inf for the one-sided alternative
    "larger".</li>
</ul>
</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">confint_proportion_ztest_2sample</span><span class="p">(</span><span class="n">count1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nobs1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">count2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nobs2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the confidence interval using normal distribution for the difference of two proportions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - count1: int, number of successes (1s) in the first sample</span>
<span class="sd">    - nobs1: int, total number of observations in the first sample</span>
<span class="sd">    - count2: int, number of successes (1s) in the second sample</span>
<span class="sd">    - nobs2: int, total number of observations in the second sample</span>
<span class="sd">    - alpha : float (default=0.05).</span>
<span class="sd">        Significance level for the confidence interval, coverage is</span>
<span class="sd">        ``1-alpha``.</span>
<span class="sd">    - alternative : (str, optional) (default=&#39;two-sided&#39;).</span>
<span class="sd">        The alternative hypothesis, H1, has to be one of the following</span>

<span class="sd">           * &#39;two-sided&#39; : H1: ``p1 - p2`` not equal to 0.</span>
<span class="sd">           * &#39;larger&#39; :   H1: ``p1 - p2 &gt; 0``</span>
<span class="sd">           * &#39;smaller&#39; :  H1: ``p1 - p2 &lt; 0``</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - ci: tuple, confidence interval (lower, upper)</span>
<span class="sd">        - lower : float</span>
<span class="sd">            Lower confidence limit. This is -inf for the one-sided alternative</span>
<span class="sd">            &quot;smaller&quot;.</span>
<span class="sd">        - upper : float</span>
<span class="sd">            Upper confidence limit. This is inf for the one-sided alternative</span>
<span class="sd">            &quot;larger&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Additional checks</span>
    <span class="k">if</span> <span class="n">nobs1</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">nobs2</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Each sample (nobs1 and nobs2) must have at least two observations&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count1</span> <span class="o">&gt;</span> <span class="n">nobs1</span> <span class="ow">or</span> <span class="n">count2</span> <span class="o">&gt;</span> <span class="n">nobs2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Count cannot be greater than sample size&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">nobs1</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">or</span> <span class="n">nobs2</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="c1"># Calculate proportions</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">count1</span> <span class="o">/</span> <span class="n">nobs1</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">count2</span> <span class="o">/</span> <span class="n">nobs2</span>

    <span class="c1"># Calculate standard error</span>
    <span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p1</span><span class="p">)</span> <span class="o">/</span> <span class="n">nobs1</span> <span class="o">+</span> <span class="n">p2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span> <span class="o">/</span> <span class="n">nobs2</span><span class="p">)</span>

    <span class="c1"># Calculate critical value and confidence interval bounds</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">]:</span>
        <span class="n">zcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span> <span class="o">-</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span> <span class="o">+</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">]:</span>
        <span class="n">zcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span> <span class="o">+</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="n">zcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span> <span class="o">+</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>

    <span class="k">return</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.confint_proportion_ztest_column_2sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">confint_proportion_ztest_column_2sample</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the confidence interval using normal distribution for the difference of two proportions.</p>
<p>Parameters:
- column: pd.Series, input column with two unique values
- alpha : float (default=0.05).
    Significance level for the confidence interval, coverage is
    <code>1-alpha</code>.
- alternative : (str, optional) (default='two-sided').
    The alternative hypothesis, H1, has to be one of the following</p>
<div class="highlight"><pre><span></span><code>   * &#39;two-sided&#39; : H1: ``p1 - p2`` not equal to 0.
   * &#39;larger&#39; :   H1: ``p1 - p2 &gt; 0``
   * &#39;smaller&#39; :  H1: ``p1 - p2 &lt; 0``
</code></pre></div>
<h6 id="pagri_data_tools.pagri_stats.confint_proportion_ztest_column_2sample--returns">Returns</h6>
<ul>
<li>ci: tuple, confidence interval (lower, upper)<ul>
<li>lower : float
    Lower confidence limit. This is -inf for the one-sided alternative
    "smaller".</li>
<li>upper : float
    Upper confidence limit. This is inf for the one-sided alternative
    "larger".</li>
</ul>
</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">confint_proportion_ztest_column_2sample</span><span class="p">(</span><span class="n">column</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the confidence interval using normal distribution for the difference of two proportions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - column: pd.Series, input column with two unique values</span>
<span class="sd">    - alpha : float (default=0.05).</span>
<span class="sd">        Significance level for the confidence interval, coverage is</span>
<span class="sd">        ``1-alpha``.</span>
<span class="sd">    - alternative : (str, optional) (default=&#39;two-sided&#39;).</span>
<span class="sd">        The alternative hypothesis, H1, has to be one of the following</span>

<span class="sd">           * &#39;two-sided&#39; : H1: ``p1 - p2`` not equal to 0.</span>
<span class="sd">           * &#39;larger&#39; :   H1: ``p1 - p2 &gt; 0``</span>
<span class="sd">           * &#39;smaller&#39; :  H1: ``p1 - p2 &lt; 0``</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - ci: tuple, confidence interval (lower, upper)</span>
<span class="sd">        - lower : float</span>
<span class="sd">            Lower confidence limit. This is -inf for the one-sided alternative</span>
<span class="sd">            &quot;smaller&quot;.</span>
<span class="sd">        - upper : float</span>
<span class="sd">            Upper confidence limit. This is inf for the one-sided alternative</span>
<span class="sd">            &quot;larger&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Validate input column</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input column must be pd.Series&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input column must have at least one value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;column must not have missing values.</span><span class="se">\n</span><span class="s1">column have </span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;column must have exactly two unique values.</span><span class="se">\n</span><span class="s1">column have </span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s1"> unique values&#39;</span><span class="p">)</span>

    <span class="n">value_counts</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">count1</span> <span class="o">=</span> <span class="n">value_counts</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">count2</span> <span class="o">=</span> <span class="n">value_counts</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">nobs1</span> <span class="o">=</span> <span class="n">nobs2</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">size</span>

    <span class="c1"># Additional checks</span>
    <span class="k">if</span> <span class="n">nobs1</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">nobs2</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Each sample (nobs1 and nobs2) must have at least two observations&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count1</span> <span class="o">&gt;</span> <span class="n">nobs1</span> <span class="ow">or</span> <span class="n">count2</span> <span class="o">&gt;</span> <span class="n">nobs2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Count cannot be greater than sample size&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">nobs1</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">or</span> <span class="n">nobs2</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>

    <span class="c1"># Calculate proportions</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">count1</span> <span class="o">/</span> <span class="n">nobs1</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">count2</span> <span class="o">/</span> <span class="n">nobs2</span>

    <span class="c1"># Calculate standard error</span>
    <span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p1</span><span class="p">)</span> <span class="o">/</span> <span class="n">nobs1</span> <span class="o">+</span> <span class="n">p2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span> <span class="o">/</span> <span class="n">nobs2</span><span class="p">)</span>

    <span class="c1"># Calculate critical value and confidence interval bounds</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">]:</span>
        <span class="n">zcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span> <span class="o">-</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span> <span class="o">+</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">]:</span>
        <span class="n">zcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span> <span class="o">+</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="n">zcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span> <span class="o">+</span> <span class="n">zcrit</span> <span class="o">*</span> <span class="n">standard_error</span>

    <span class="k">return</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.confint_t_1sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">confint_t_1sample</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the confidence interval using t-statistic for the mean of one sample.</p>
<p>Parameters:
- sample: Pandas Series object
- alpha : float (default=0.05).
    Significance level for the confidence interval, coverage is
    <code>1-alpha</code>.
- alternative : (str, optional) (default='two-sided').
    The alternative hypothesis, H1, has to be one of the following</p>
<div class="highlight"><pre><span></span><code>   * &#39;two-sided&#39; : H1: ``value - mu`` not equal to 0.
   * &#39;larger&#39; :   H1: ``value - mu &gt; 0``
   * &#39;smaller&#39; :  H1: ``value - mu &lt; 0``
</code></pre></div>
<h6 id="pagri_data_tools.pagri_stats.confint_t_1sample--returns">Returns</h6>
<ul>
<li>ci: tuple, confidence interval (lower, upper)<ul>
<li>lower : float
    Lower confidence limit. This is -inf for the one-sided alternative
    "smaller".</li>
<li>upper : float
    Upper confidence limit. This is inf for the one-sided alternative
    "larger".</li>
</ul>
</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">confint_t_1sample</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the confidence interval using t-statistic for the mean of one sample.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - sample: Pandas Series object</span>
<span class="sd">    - alpha : float (default=0.05).</span>
<span class="sd">        Significance level for the confidence interval, coverage is</span>
<span class="sd">        ``1-alpha``.</span>
<span class="sd">    - alternative : (str, optional) (default=&#39;two-sided&#39;).</span>
<span class="sd">        The alternative hypothesis, H1, has to be one of the following</span>

<span class="sd">           * &#39;two-sided&#39; : H1: ``value - mu`` not equal to 0.</span>
<span class="sd">           * &#39;larger&#39; :   H1: ``value - mu &gt; 0``</span>
<span class="sd">           * &#39;smaller&#39; :  H1: ``value - mu &lt; 0``</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - ci: tuple, confidence interval (lower, upper)</span>
<span class="sd">        - lower : float</span>
<span class="sd">            Lower confidence limit. This is -inf for the one-sided alternative</span>
<span class="sd">            &quot;smaller&quot;.</span>
<span class="sd">        - upper : float</span>
<span class="sd">            Upper confidence limit. This is inf for the one-sided alternative</span>
<span class="sd">            &quot;larger&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Check if sample is Pandas Series object</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sample must be Pandas Series object&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sample must have at least two elements&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="c1"># Calculate mean and variance</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">sample</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Calculate sample size</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

    <span class="c1"># Calculate standard error</span>
    <span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>

    <span class="c1"># Calculate degrees of freedom</span>
    <span class="n">dof</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c1"># Calculate critical value and confidence interval bounds</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">]:</span>
        <span class="n">tcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">-</span> <span class="n">tcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">tcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">]:</span>
        <span class="n">tcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">tcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="n">tcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">tcrit</span> <span class="o">*</span> <span class="n">standard_error</span>

    <span class="k">return</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.confint_t_2samples" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">confint_t_2samples</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the confidence interval using t-statistic for the difference in means between two samples.</p>
<p>Parameters:
- sample1, sample2: Pandas Series objects
- alpha : float (default=0.05).
    Significance level for the confidence interval, coverage is
    <code>1-alpha</code>.
- alternative : (str, optional) (default='two-sided').
    The alternative hypothesis, H1, has to be one of the following</p>
<div class="highlight"><pre><span></span><code>   * &#39;two-sided&#39; : H1: ``value1 - value2 - diff`` not equal to 0.
   * &#39;larger&#39; :   H1: ``value1 - value2 - diff &gt; 0``
   * &#39;smaller&#39; :  H1: ``value1 - value2 - diff &lt; 0``
</code></pre></div>
<ul>
<li>equal_var (bool): Whether to assume equal variances between the two samples. If <code>True</code>, the pooled standard deviation is used. <br />
If <code>False</code>, the standard error is calculated using the separate variances of each sample. Defaults to <code>False</code>.</li>
</ul>
<h6 id="pagri_data_tools.pagri_stats.confint_t_2samples--returns">Returns</h6>
<ul>
<li>ci: tuple, confidence interval (lower, upper)<ul>
<li>lower : float
    Lower confidence limit. This is -inf for the one-sided alternative
    "smaller".</li>
<li>upper : float
    Upper confidence limit. This is inf for the one-sided alternative
    "larger".</li>
</ul>
</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">confint_t_2samples</span><span class="p">(</span><span class="n">sample1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">sample2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the confidence interval using t-statistic for the difference in means between two samples.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - sample1, sample2: Pandas Series objects</span>
<span class="sd">    - alpha : float (default=0.05).</span>
<span class="sd">        Significance level for the confidence interval, coverage is</span>
<span class="sd">        ``1-alpha``.</span>
<span class="sd">    - alternative : (str, optional) (default=&#39;two-sided&#39;).</span>
<span class="sd">        The alternative hypothesis, H1, has to be one of the following</span>

<span class="sd">           * &#39;two-sided&#39; : H1: ``value1 - value2 - diff`` not equal to 0.</span>
<span class="sd">           * &#39;larger&#39; :   H1: ``value1 - value2 - diff &gt; 0``</span>
<span class="sd">           * &#39;smaller&#39; :  H1: ``value1 - value2 - diff &lt; 0``</span>
<span class="sd">    - equal_var (bool): Whether to assume equal variances between the two samples. If `True`, the pooled standard deviation is used.   </span>
<span class="sd">    If `False`, the standard error is calculated using the separate variances of each sample. Defaults to `False`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - ci: tuple, confidence interval (lower, upper)</span>
<span class="sd">        - lower : float</span>
<span class="sd">            Lower confidence limit. This is -inf for the one-sided alternative</span>
<span class="sd">            &quot;smaller&quot;.</span>
<span class="sd">        - upper : float</span>
<span class="sd">            Upper confidence limit. This is inf for the one-sided alternative</span>
<span class="sd">            &quot;larger&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Check if samples are Pandas Series objects</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample2</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Samples must be Pandas Series objects&quot;</span><span class="p">)</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="c1"># Calculate means and variances</span>
    <span class="n">mean1</span><span class="p">,</span> <span class="n">var1</span> <span class="o">=</span> <span class="n">sample1</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">sample1</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">mean2</span><span class="p">,</span> <span class="n">var2</span> <span class="o">=</span> <span class="n">sample2</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">sample2</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Calculate sample sizes</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">equal_var</span><span class="p">:</span>
        <span class="c1"># Calculate pooled standard deviation</span>
        <span class="n">pooled_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="p">((</span><span class="n">n1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">+</span> <span class="p">(</span><span class="n">n2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">var2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">standard_error</span> <span class="o">=</span> <span class="n">pooled_std</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">n2</span><span class="p">)</span>

        <span class="n">dof</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">varn1</span> <span class="o">=</span> <span class="n">var1</span> <span class="o">/</span> <span class="n">n1</span>
        <span class="n">varn2</span> <span class="o">=</span> <span class="n">var2</span> <span class="o">/</span> <span class="n">n2</span>
        <span class="n">dof</span> <span class="o">=</span> <span class="p">(</span><span class="n">varn1</span> <span class="o">+</span> <span class="n">varn2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">varn1</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">varn2</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">varn1</span> <span class="o">+</span> <span class="n">varn2</span><span class="p">)</span>

    <span class="c1"># Calculate critical value and confidence interval bounds</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">]:</span>
        <span class="n">tcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span> <span class="o">-</span> <span class="n">tcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span> <span class="o">+</span> <span class="n">tcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">]:</span>
        <span class="n">tcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span> <span class="o">+</span> <span class="n">tcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="n">tcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span> <span class="o">+</span> <span class="n">tcrit</span> <span class="o">*</span> <span class="n">standard_error</span>

    <span class="k">return</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.confint_t_2samples_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">confint_t_2samples_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">reference_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the confidence interval using t-statistic for the difference in means between two samples.</p>
<p>Parameters:
- df (pd.DataFrame): DataFrame containing two columns, where the first column contains labels and the second column contains values
- alpha : float (default=0.05).
    Significance level for the confidence interval, coverage is
    <code>1-alpha</code>.
- alternative : (str, optional) (default='two-sided').
    The alternative hypothesis, H1, has to be one of the following</p>
<div class="highlight"><pre><span></span><code>   * &#39;two-sided&#39; : H1: ``value1 - value2 - diff`` not equal to 0.
   * &#39;larger&#39; :   H1: ``value1 - value2 - diff &gt; 0``
   * &#39;smaller&#39; :  H1: ``value1 - value2 - diff &lt; 0``
</code></pre></div>
<ul>
<li>reference_group (str, optional): Lable name in first column of df for define first sample for scipy.stats.ttest_ind</li>
<li>equal_var (bool): Whether to assume equal variances between the two samples. If <code>True</code>, the pooled standard deviation is used. <br />
If <code>False</code>, the standard error is calculated using the separate variances of each sample. Defaults to <code>False</code>.</li>
</ul>
<h6 id="pagri_data_tools.pagri_stats.confint_t_2samples_df--returns">Returns</h6>
<ul>
<li>ci: tuple, confidence interval (lower, upper)<ul>
<li>lower : float
    Lower confidence limit. This is -inf for the one-sided alternative
    "smaller".</li>
<li>upper : float
    Upper confidence limit. This is inf for the one-sided alternative
    "larger".</li>
</ul>
</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">confint_t_2samples_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">reference_group</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the confidence interval using t-statistic for the difference in means between two samples.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - df (pd.DataFrame): DataFrame containing two columns, where the first column contains labels and the second column contains values</span>
<span class="sd">    - alpha : float (default=0.05).</span>
<span class="sd">        Significance level for the confidence interval, coverage is</span>
<span class="sd">        ``1-alpha``.</span>
<span class="sd">    - alternative : (str, optional) (default=&#39;two-sided&#39;).</span>
<span class="sd">        The alternative hypothesis, H1, has to be one of the following</span>

<span class="sd">           * &#39;two-sided&#39; : H1: ``value1 - value2 - diff`` not equal to 0.</span>
<span class="sd">           * &#39;larger&#39; :   H1: ``value1 - value2 - diff &gt; 0``</span>
<span class="sd">           * &#39;smaller&#39; :  H1: ``value1 - value2 - diff &lt; 0``</span>
<span class="sd">    - reference_group (str, optional): Lable name in first column of df for define first sample for scipy.stats.ttest_ind</span>
<span class="sd">    - equal_var (bool): Whether to assume equal variances between the two samples. If `True`, the pooled standard deviation is used.   </span>
<span class="sd">    If `False`, the standard error is calculated using the separate variances of each sample. Defaults to `False`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    - ci: tuple, confidence interval (lower, upper)</span>
<span class="sd">        - lower : float</span>
<span class="sd">            Lower confidence limit. This is -inf for the one-sided alternative</span>
<span class="sd">            &quot;smaller&quot;.</span>
<span class="sd">        - upper : float</span>
<span class="sd">            Upper confidence limit. This is inf for the one-sided alternative</span>
<span class="sd">            &quot;larger&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Check if input is a Pandas DataFrame</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input must be a Pandas DataFrame&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input DataFrame must have exactly two columns&quot;</span><span class="p">)</span>

    <span class="c1"># Extract labels and values from the DataFrame</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Check if values are numeric</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Values must be numeric&quot;</span><span class="p">)</span>

    <span class="c1"># Check for missing values</span>
    <span class="k">if</span> <span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Labels and values must not have missing values&quot;</span><span class="p">)</span>

    <span class="c1"># Extract unique labels</span>
    <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Labels must contain exactly two unique values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reference_group</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">reference_group</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_labels</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;reference_group must be a lable in first column of df&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reference_group</span> <span class="o">!=</span> <span class="n">unique_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">unique_labels</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># Split values into two samples based on labels</span>
    <span class="n">sample1</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">unique_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">sample2</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">unique_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="c1"># Calculate means and variances</span>
    <span class="n">mean1</span><span class="p">,</span> <span class="n">var1</span> <span class="o">=</span> <span class="n">sample1</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">sample1</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">mean2</span><span class="p">,</span> <span class="n">var2</span> <span class="o">=</span> <span class="n">sample2</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">sample2</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Calculate sample sizes</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">equal_var</span><span class="p">:</span>
        <span class="c1"># Calculate pooled standard deviation</span>
        <span class="n">pooled_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="p">((</span><span class="n">n1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">var1</span> <span class="o">+</span> <span class="p">(</span><span class="n">n2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">var2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">standard_error</span> <span class="o">=</span> <span class="n">pooled_std</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">n2</span><span class="p">)</span>

        <span class="n">dof</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">varn1</span> <span class="o">=</span> <span class="n">var1</span> <span class="o">/</span> <span class="n">n1</span>
        <span class="n">varn2</span> <span class="o">=</span> <span class="n">var2</span> <span class="o">/</span> <span class="n">n2</span>
        <span class="n">dof</span> <span class="o">=</span> <span class="p">(</span><span class="n">varn1</span> <span class="o">+</span> <span class="n">varn2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">varn1</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">varn2</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">varn1</span> <span class="o">+</span> <span class="n">varn2</span><span class="p">)</span>

    <span class="c1"># Calculate critical value and confidence interval bounds</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">]:</span>
        <span class="n">tcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span> <span class="o">-</span> <span class="n">tcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span> <span class="o">+</span> <span class="n">tcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">]:</span>
        <span class="n">tcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span> <span class="o">+</span> <span class="n">tcrit</span> <span class="o">*</span> <span class="n">standard_error</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="n">tcrit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span> <span class="o">+</span> <span class="n">tcrit</span> <span class="o">*</span> <span class="n">standard_error</span>

    <span class="k">return</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.dunn_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dunn_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">p_adjust</span><span class="o">=</span><span class="s1">&#39;holm&#39;</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a Dunn's test. The Dunn's test is a non-parametric test used to compare the medians of multiple groups.
It is a post-hoc test used to determine which pairs of groups are significantly different after a Kruskal-Wallis test.</p>
<h6 id="pagri_data_tools.pagri_stats.dunn_df--parameters">Parameters:</h6>
<p>df : pd.DataFrame
    DataFrame containing two columns
    - first column contains labels and
    - second column contains corresponding values
p_adjust : str, optional
    Method for adjusting p-values for multiple comparisons (default: None). Available methods are:
    - 'holm' (Holm-Bonferroni method)
    - 'bonferroni' (Bonferroni method)
    - 'fdr_bh' (Benjamini-Hochberg method)
    - 'fdr_by' (Benjamini-Yekutieli method)
    - 'none' (no adjustment)</p>
<h6 id="pagri_data_tools.pagri_stats.dunn_df--returns">Returns:</h6>
<p>None</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span>
<span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span>
<span class="normal">2675</span>
<span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span>
<span class="normal">2688</span>
<span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dunn_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">p_adjust</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;holm&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a Dunn&#39;s test. The Dunn&#39;s test is a non-parametric test used to compare the medians of multiple groups.</span>
<span class="sd">    It is a post-hoc test used to determine which pairs of groups are significantly different after a Kruskal-Wallis test.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        DataFrame containing two columns</span>
<span class="sd">        - first column contains labels and</span>
<span class="sd">        - second column contains corresponding values</span>
<span class="sd">    p_adjust : str, optional</span>
<span class="sd">        Method for adjusting p-values for multiple comparisons (default: None). Available methods are:</span>
<span class="sd">        - &#39;holm&#39; (Holm-Bonferroni method)</span>
<span class="sd">        - &#39;bonferroni&#39; (Bonferroni method)</span>
<span class="sd">        - &#39;fdr_bh&#39; (Benjamini-Hochberg method)</span>
<span class="sd">        - &#39;fdr_by&#39; (Benjamini-Yekutieli method)</span>
<span class="sd">        - &#39;none&#39; (no adjustment)</span>

<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input df must be pd.DataFrame&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input DataFrame must have exactly two columns&quot;</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">CategoricalDtype</span><span class="p">):</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value column must contain numeric values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;labels and values must not have missing values.</span><span class="se">\n</span><span class="s1">labels have </span><span class="si">{</span><span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values</span><span class="se">\n</span><span class="s1">values have </span><span class="si">{</span><span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_labels</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Labels must contain at least two unique values&quot;</span><span class="p">)</span>

    <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">unique_labels</span><span class="p">:</span>
        <span class="n">sample_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">label</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sample_size</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sample_size</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>

    <span class="n">group_col</span><span class="p">,</span> <span class="n">val_col</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">p_values</span> <span class="o">=</span> <span class="n">scikit_posthocs</span><span class="o">.</span><span class="n">posthoc_dunn</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">val_col</span><span class="o">=</span><span class="n">val_col</span><span class="p">,</span> <span class="n">group_col</span><span class="o">=</span><span class="n">group_col</span><span class="p">,</span> <span class="n">p_adjust</span><span class="o">=</span><span class="n">p_adjust</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span>
        <span class="n">p_values</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;Тест Данна&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">set_table_styles</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;caption&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">(</span><span class="s2">&quot;font-size&quot;</span><span class="p">,</span> <span class="s2">&quot;14px&quot;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s2">&quot;text-align&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s2">&quot;font-weight&quot;</span><span class="p">,</span> <span class="s2">&quot;bold&quot;</span><span class="p">),</span>
                    <span class="p">],</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.games_howell_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">games_howell_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a Games-Howell test for pairwise comparisons.
This test is used to identify significant differences between groups when variances are unequal.</p>
        <ul>
<li>df (pd.DataFrame): DataFrame containing two columns,
    where the first column contains labels and
    the second column contains corresponding values</li>
<li>alpha (float, optional): Significance level (default: 0.05)</li>
</ul>
<p>Returns:
- None</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">games_howell_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a Games-Howell test for pairwise comparisons.</span>
<span class="sd">    This test is used to identify significant differences between groups when variances are unequal.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - df (pd.DataFrame): DataFrame containing two columns,</span>
<span class="sd">        where the first column contains labels and</span>
<span class="sd">        the second column contains corresponding values</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>

<span class="sd">    Returns:</span>
<span class="sd">    - None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Input validation</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input df must be pd.DataFrame&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input DataFrame must have exactly two columns&quot;</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value column must contain numeric values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;labels and values must not have missing values.</span><span class="se">\n</span><span class="s1">labels have </span><span class="si">{</span><span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values</span><span class="se">\n</span><span class="s1">values have </span><span class="si">{</span><span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_labels</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Labels must contain at least two unique values&quot;</span><span class="p">)</span>

    <span class="c1"># Perform Games-Howell test</span>
    <span class="n">gh_test</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">pairwise_gameshowell</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">dv</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">between</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">gh_test</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.kruskal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">kruskal</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a Kruskal-Wallis test. The Kruskal-Wallis H-test tests the null hypothesis<br />
that the population median of all of the groups are equal. It is a non-parametric version of ANOVA. </p>
<p>Parameters:
- samples (list): List of pd.Series, where each pd.Series contains values. There must be at least two samples.
- alpha (float, optional): Significance level (default: 0.05)
- return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False)</p>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - statistic : (float)
        The calculated H-statistic.
    - pvalue : (float)
        The associated p-value from the chi-squared distribution</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">kruskal</span><span class="p">(</span><span class="n">samples</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a Kruskal-Wallis test. The Kruskal-Wallis H-test tests the null hypothesis  </span>
<span class="sd">    that the population median of all of the groups are equal. It is a non-parametric version of ANOVA. </span>

<span class="sd">    Parameters:</span>
<span class="sd">    - samples (list): List of pd.Series, where each pd.Series contains values. There must be at least two samples.</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False)</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - statistic : (float)</span>
<span class="sd">            The calculated H-statistic.</span>
<span class="sd">        - pvalue : (float)</span>
<span class="sd">            The associated p-value from the chi-squared distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input samples must be a list of pd.Series&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All values in samples must be numeric&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All samples must have at least one value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must have at least two samples&quot;</span><span class="p">)</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kruskal</span><span class="p">(</span><span class="o">*</span><span class="n">samples</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Тест Краскела-Уоллиса (H-критерий)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.kruskal_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">kruskal_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a Kruskal-Wallis test. The Kruskal-Wallis H-test tests the null hypothesis<br />
that the population median of all of the groups are equal. It is a non-parametric version of ANOVA. </p>
<h6 id="pagri_data_tools.pagri_stats.kruskal_df--parameters">Parameters</h6>
<p>df : pd.DataFrame
    DataFrame containing two columns
    - first column contains labels and
    - second column contains corresponding values
alpha : float, optional
    Significance level (default: 0.05)
return_results : bool, optional
    Whether to return results (statistic, p_value) instead of printing (default=False).</p>
<h6 id="pagri_data_tools.pagri_stats.kruskal_df--returns">Returns</h6>
<ul>
<li>If return_results is False: None</li>
<li>If return_results is True<ul>
<li>statistic : (float)
    The calculated H-statistic.</li>
<li>pvalue : (float)
    The associated p-value from the chi-squared distribution</li>
</ul>
</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">kruskal_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a Kruskal-Wallis test. The Kruskal-Wallis H-test tests the null hypothesis  </span>
<span class="sd">    that the population median of all of the groups are equal. It is a non-parametric version of ANOVA. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        DataFrame containing two columns</span>
<span class="sd">        - first column contains labels and</span>
<span class="sd">        - second column contains corresponding values</span>
<span class="sd">    alpha : float, optional</span>
<span class="sd">        Significance level (default: 0.05)</span>
<span class="sd">    return_results : bool, optional</span>
<span class="sd">        Whether to return results (statistic, p_value) instead of printing (default=False).</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - statistic : (float)</span>
<span class="sd">            The calculated H-statistic.</span>
<span class="sd">        - pvalue : (float)</span>
<span class="sd">            The associated p-value from the chi-squared distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input df must be pd.DataFrame&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input DataFrame must have exactly two columns&quot;</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value column must contain numeric values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;labels and values must not have missing values.</span><span class="se">\n</span><span class="s1">labels have </span><span class="si">{</span><span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values</span><span class="se">\n</span><span class="s1">values have </span><span class="si">{</span><span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_labels</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Labels must contain at least two unique values&quot;</span><span class="p">)</span>

    <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">label</span><span class="p">]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">unique_labels</span><span class="p">]</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kruskal</span><span class="p">(</span><span class="o">*</span><span class="n">samples</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Тест Краскела-Уоллиса (H-критерий)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.kruskal_report" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">kruskal_report</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a Kruskal-Wallis test and generate a detailed report.</p>
<h6 id="pagri_data_tools.pagri_stats.kruskal_report--parameters">Parameters:</h6>
<p>df : pd.DataFrame
    The DataFrame containing the data for analysis.
category_column : str
    The name of the column in <code>df</code> that contains the group labels (categories).
    This column should have exactly two unique values representing the two groups to compare.
numeric_column : str
    The name of the column in <code>df</code> that contains the numeric values to compare between the two groups.
alpha : float, optional
    The significance level for the hypothesis tests. Default is 0.05.</p>
<h6 id="pagri_data_tools.pagri_stats.kruskal_report--returns">Returns:</h6>
<p>None</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span>
<span class="normal">2971</span>
<span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span>
<span class="normal">2979</span>
<span class="normal">2980</span>
<span class="normal">2981</span>
<span class="normal">2982</span>
<span class="normal">2983</span>
<span class="normal">2984</span>
<span class="normal">2985</span>
<span class="normal">2986</span>
<span class="normal">2987</span>
<span class="normal">2988</span>
<span class="normal">2989</span>
<span class="normal">2990</span>
<span class="normal">2991</span>
<span class="normal">2992</span>
<span class="normal">2993</span>
<span class="normal">2994</span>
<span class="normal">2995</span>
<span class="normal">2996</span>
<span class="normal">2997</span>
<span class="normal">2998</span>
<span class="normal">2999</span>
<span class="normal">3000</span>
<span class="normal">3001</span>
<span class="normal">3002</span>
<span class="normal">3003</span>
<span class="normal">3004</span>
<span class="normal">3005</span>
<span class="normal">3006</span>
<span class="normal">3007</span>
<span class="normal">3008</span>
<span class="normal">3009</span>
<span class="normal">3010</span>
<span class="normal">3011</span>
<span class="normal">3012</span>
<span class="normal">3013</span>
<span class="normal">3014</span>
<span class="normal">3015</span>
<span class="normal">3016</span>
<span class="normal">3017</span>
<span class="normal">3018</span>
<span class="normal">3019</span>
<span class="normal">3020</span>
<span class="normal">3021</span>
<span class="normal">3022</span>
<span class="normal">3023</span>
<span class="normal">3024</span>
<span class="normal">3025</span>
<span class="normal">3026</span>
<span class="normal">3027</span>
<span class="normal">3028</span>
<span class="normal">3029</span>
<span class="normal">3030</span>
<span class="normal">3031</span>
<span class="normal">3032</span>
<span class="normal">3033</span>
<span class="normal">3034</span>
<span class="normal">3035</span>
<span class="normal">3036</span>
<span class="normal">3037</span>
<span class="normal">3038</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">kruskal_report</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">category_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">numeric_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a Kruskal-Wallis test and generate a detailed report.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        The DataFrame containing the data for analysis.</span>
<span class="sd">    category_column : str</span>
<span class="sd">        The name of the column in `df` that contains the group labels (categories).</span>
<span class="sd">        This column should have exactly two unique values representing the two groups to compare.</span>
<span class="sd">    numeric_column : str</span>
<span class="sd">        The name of the column in `df` that contains the numeric values to compare between the two groups.</span>
<span class="sd">    alpha : float, optional</span>
<span class="sd">        The significance level for the hypothesis tests. Default is 0.05.</span>

<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check if the category column exists in the DataFrame</span>
    <span class="k">if</span> <span class="n">category_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">category_column</span><span class="si">}</span><span class="s2">&#39; not found in DataFrame.&quot;</span><span class="p">)</span>
    <span class="c1"># Check if the numeric column exists in the DataFrame</span>
    <span class="k">if</span> <span class="n">numeric_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">numeric_column</span><span class="si">}</span><span class="s2">&#39; not found in DataFrame.&quot;</span><span class="p">)</span>
    <span class="c1"># Ensure the numeric column contains numeric data</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numeric_column</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">numeric_column</span><span class="si">}</span><span class="s2">&#39; must contain numeric data.&quot;</span><span class="p">)</span>
    <span class="c1"># Verify that the category column contains exactly two unique groups</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">category_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">category_column</span><span class="si">}</span><span class="s2">&#39; must contain at least two unique groups.&quot;</span><span class="p">)</span>

    <span class="c1"># Remove missing values from the data</span>
    <span class="n">df_clean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Так как распределения средних далеки от нормальных, то будем использовать тест Краскела-Уоллиса&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="c1"># State the null and alternative hypotheses</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 1: Формулировка гипотез.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H0: Распределения во всех группах одинаковы.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H1: Распределение хотя бы в одной группе отличается от других.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 2: Выбор уровня значимости.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Уровень значимости alpha выберем </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="c1"># Check the sample size in each group</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 3: Проверка размеров групп.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="n">display</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[</span><span class="n">category_column</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">())</span>

    <span class="c1"># Perform test</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 4: Проведение теста.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">p_value_kruskal</span> <span class="o">=</span> <span class="n">kruskal_df</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]]</span>
                    <span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span>
                    <span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">p_value_kruskal</span> <span class="o">&gt;=</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 4: Проведение теста.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Так как нулевая гипотеза отвергнута, проведем тест Данна , чтобы обнаружить между какими группами есть различия.&#39;</span><span class="p">)</span>
        <span class="n">dunn_df</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.levene" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">levene</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a Levene's test. Levene's test is a statistical test used to check if the variances of multiple samples are equal.</p>
<p>Parameters:
- samples (list): List of pd.Series, where each pd.Series contains values. There must be at least two samples.
- alpha (float, optional): Significance level (default: 0.05)
- return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False)</p>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - statistic : (float)
        The calculated W-statistic.
    - pvalue : (float)
        The associated p-value from the F distribution</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">levene</span><span class="p">(</span><span class="n">samples</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a Levene&#39;s test. Levene&#39;s test is a statistical test used to check if the variances of multiple samples are equal.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - samples (list): List of pd.Series, where each pd.Series contains values. There must be at least two samples.</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False)</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - statistic : (float)</span>
<span class="sd">            The calculated W-statistic.</span>
<span class="sd">        - pvalue : (float)</span>
<span class="sd">            The associated p-value from the F distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input samples must be a list of pd.Series&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All values in samples must be numeric&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All samples must have at least one value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must have at least two samples&quot;</span><span class="p">)</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>

    <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">levene</span><span class="p">(</span><span class="o">*</span><span class="n">samples</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Тест Левена&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.levene_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">levene_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a Levene's test. Levene's test is a statistical test used to check if the variances of multiple samples are equal.</p>
        <ul>
<li>df (pd.DataFrame): DataFrame containing two columns,
    where the first column contains labels and
    the second column contains corresponding values</li>
<li>alpha (float, optional): Significance level (default: 0.05)</li>
<li>return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False).</li>
</ul>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - statistic : (float)
        The calculated W-statistic.
    - pvalue : (float)
        The associated p-value from the F distribution</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">levene_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a Levene&#39;s test. Levene&#39;s test is a statistical test used to check if the variances of multiple samples are equal.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - df (pd.DataFrame): DataFrame containing two columns,</span>
<span class="sd">        where the first column contains labels and</span>
<span class="sd">        the second column contains corresponding values</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - statistic : (float)</span>
<span class="sd">            The calculated W-statistic.</span>
<span class="sd">        - pvalue : (float)</span>
<span class="sd">            The associated p-value from the F distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input df must be pd.DataFrame&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input DataFrame must have exactly two columns&quot;</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value column must contain numeric values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;labels and values must not have missing values.</span><span class="se">\n</span><span class="s1">labels have </span><span class="si">{</span><span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values</span><span class="se">\n</span><span class="s1">values have </span><span class="si">{</span><span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_labels</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Labels must contain at least two unique values&quot;</span><span class="p">)</span>

    <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">label</span><span class="p">]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">unique_labels</span><span class="p">]</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">levene</span><span class="p">(</span><span class="o">*</span><span class="n">samples</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Тест Левена&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.linear_regression_with_vif" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">linear_regression_with_vif</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">target_column</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform linear regression with variance inflation factor (VIF) analysis.</p>
<p>Parameters:
df (pd.DataFrame): Input DataFrame containing the data.
target_column (str): Name of the target column.</p>
<p>Returns:
None</p>
<p>Description:
This function performs linear regression on the input DataFrame with the specified target column.
It first selects only the numeric columns, drops any rows with missing values, and then splits the data into features (X) and target (y).
A constant term is added to the independent variables (X) using <code>sm.add_constant(X)</code>.
The function then fits an ordinary least squares (OLS) model with heteroscedasticity-consistent standard errors (HC1).
The variance inflation factor (VIF) is calculated for each feature, and the results are displayed along with the model summary.</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">linear_regression_with_vif</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform linear regression with variance inflation factor (VIF) analysis.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pd.DataFrame): Input DataFrame containing the data.</span>
<span class="sd">    target_column (str): Name of the target column.</span>

<span class="sd">    Returns:</span>
<span class="sd">    None</span>

<span class="sd">    Description:</span>
<span class="sd">    This function performs linear regression on the input DataFrame with the specified target column.</span>
<span class="sd">    It first selects only the numeric columns, drops any rows with missing values, and then splits the data into features (X) and target (y).</span>
<span class="sd">    A constant term is added to the independent variables (X) using `sm.add_constant(X)`.</span>
<span class="sd">    The function then fits an ordinary least squares (OLS) model with heteroscedasticity-consistent standard errors (HC1).</span>
<span class="sd">    The variance inflation factor (VIF) is calculated for each feature, and the results are displayed along with the model summary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Select numeric columns and drop rows with missing values</span>
    <span class="n">num_columns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])]</span>
    <span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">num_columns</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">target_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_tmp</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Target column &#39;</span><span class="si">{</span><span class="n">target_column</span><span class="si">}</span><span class="s2">&#39; not found in the DataFrame.&quot;</span><span class="p">)</span>
    <span class="c1"># Split data into features (X) and target (y)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">df_tmp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">target_column</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df_tmp</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span>

    <span class="c1"># Add a constant term to the independent variables</span>
    <span class="c1"># This operation is necessary to allow the OLS model to capture the effect of the constant term on the dependent variable, </span>
    <span class="c1"># as assuming it is zero when all independent variables are zero may not always be accurate.</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="c1"># Fit OLS model with HC1 standard errors</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s1">&#39;HC1&#39;</span><span class="p">)</span>

    <span class="c1"># Calculate VIF for each feature</span>
    <span class="n">vif</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

    <span class="c1"># Create a DataFrame with coefficients and VIF</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Coef&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="s1">&#39;VIF&#39;</span><span class="p">:</span> <span class="n">vif</span><span class="p">})</span>

    <span class="c1"># Display results</span>
    <span class="n">display</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>  <span class="c1"># exclude the constant term</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.mannwhitneyu" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform the Mann-Whitney U rank test on two independent samples.</p>
<p>Parameters:
- sample1 (pd.Series): First sample values
- sample2 (pd.Series): Second sample values
- alpha (float, optional): Significance level (default: 0.05)
- alternative (str, optional): Alternative hypothesis ('two-sided', '2s', 'larger', 'l', 'smaller', 's') (default: 'two-sided')
- return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False).</p>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - statistic : (float)
        The Mann-Whitney U statistic corresponding with sample x. See Notes for the test statistic corresponding with sample y.
    - pvalue : (float)
        The associated <em>p</em>-value for the chosen alternative.</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mannwhitneyu</span><span class="p">(</span><span class="n">sample1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">sample2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform the Mann-Whitney U rank test on two independent samples.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - sample1 (pd.Series): First sample values</span>
<span class="sd">    - sample2 (pd.Series): Second sample values</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - alternative (str, optional): Alternative hypothesis (&#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;) (default: &#39;two-sided&#39;)</span>
<span class="sd">    - return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - statistic : (float)</span>
<span class="sd">            The Mann-Whitney U statistic corresponding with sample x. See Notes for the test statistic corresponding with sample y.</span>
<span class="sd">        - pvalue : (float)</span>
<span class="sd">            The associated *p*-value for the chosen alternative.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;greater&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;greater&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;less&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;less&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input samples must be pd.Series&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All samples must have at least one value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">sample2</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;sample1 and sample2 must contain numeric values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sample1</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">sample2</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;sample1 and sample2 must not have missing values.</span><span class="se">\n</span><span class="s1">sample1 have </span><span class="si">{</span><span class="n">sample1</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values</span><span class="se">\n</span><span class="s1">sample2 have </span><span class="si">{</span><span class="n">sample2</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span>
        <span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="n">alternative</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;U-критерий Манна-Уитни&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.mannwhitneyu_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mannwhitneyu_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">reference_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform the Mann-Whitney U rank test on two independent samples.</p>
        <ul>
<li>df (pd.DataFrame): DataFrame containing two columns,
    where the first column contains sample labels (e.g., "male" and "female") and
    the second column contains corresponding values</li>
<li>alpha (float, optional): Significance level (default: 0.05)</li>
<li>alternative (str, optional): Alternative hypothesis ('two-sided', '2s', 'larger', 'l', 'smaller', 's') (default: 'two-sided')</li>
<li>reference_group (str, optional): Lable name in first column of df for define first sample for scipy.stats.ttest_ind</li>
<li>return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False).</li>
</ul>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - statistic : (float)
        The Mann-Whitney U statistic corresponding with sample x. See Notes for the test statistic corresponding with sample y.
    - pvalue : (float)
        The associated <em>p</em>-value for the chosen alternative.</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mannwhitneyu_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">reference_group</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform the Mann-Whitney U rank test on two independent samples.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - df (pd.DataFrame): DataFrame containing two columns,</span>
<span class="sd">        where the first column contains sample labels (e.g., &quot;male&quot; and &quot;female&quot;) and</span>
<span class="sd">        the second column contains corresponding values</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - alternative (str, optional): Alternative hypothesis (&#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;) (default: &#39;two-sided&#39;)</span>
<span class="sd">    - reference_group (str, optional): Lable name in first column of df for define first sample for scipy.stats.ttest_ind</span>
<span class="sd">    - return_results (bool, optional): Return (statistic, p_value) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - statistic : (float)</span>
<span class="sd">            The Mann-Whitney U statistic corresponding with sample x. See Notes for the test statistic corresponding with sample y.</span>
<span class="sd">        - pvalue : (float)</span>
<span class="sd">            The associated *p*-value for the chosen alternative.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;greater&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;greater&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;less&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;less&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input df must be pd.DataFrame&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input DataFrame must have exactly two columns&quot;</span><span class="p">)</span>
    <span class="n">sample_column</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">value_column</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">value_column</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value column must contain numeric values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sample_column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">value_column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;sample_column and value_column must not have missing values.</span><span class="se">\n</span><span class="s1">sample_column have </span><span class="si">{</span><span class="n">sample_column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values</span><span class="se">\n</span><span class="s1">value_column have </span><span class="si">{</span><span class="n">value_column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="n">unique_samples</span> <span class="o">=</span> <span class="n">sample_column</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_samples</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Sample column must contain exactly two unique labels&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reference_group</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">reference_group</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_samples</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;reference_group must be a lable in first column of df&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reference_group</span> <span class="o">!=</span> <span class="n">unique_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">unique_samples</span> <span class="o">=</span> <span class="n">unique_samples</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sample1_values</span> <span class="o">=</span> <span class="n">value_column</span><span class="p">[</span><span class="n">sample_column</span> <span class="o">==</span> <span class="n">unique_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">sample2_values</span> <span class="o">=</span> <span class="n">value_column</span><span class="p">[</span><span class="n">sample_column</span> <span class="o">==</span> <span class="n">unique_samples</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1_values</span><span class="p">,</span> <span class="n">sample2_values</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span>
        <span class="n">sample1_values</span><span class="p">,</span> <span class="n">sample2_values</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="n">alternative</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;U-критерий Манна-Уитни&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.mannwhitneyu_report" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mannwhitneyu_report</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">reference_group</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform Mann-Whitney U rank test and generate a detailed report.</p>
<h6 id="pagri_data_tools.pagri_stats.mannwhitneyu_report--parameters">Parameters:</h6>
<p>df : pd.DataFrame
    The DataFrame containing the data for analysis.
category_column : str
    The name of the column in <code>df</code> that contains the group labels (categories).
    This column should have exactly two unique values representing the two groups to compare.
numeric_column : str
    The name of the column in <code>df</code> that contains the numeric values to compare between the two groups.
alpha : float, optional
    The significance level for the hypothesis tests. Default is 0.05.
alternative : str, optional
    The alternative hypothesis for test. Possible values are:
    - 'two-sided' or '2s': The means of the two groups are not equal (default).
    - 'larger' or 'l': The mean of the first group is larger than the mean of the second group.
    - 'smaller' or 's': The mean of the first group is smaller than the mean of the second group.
reference_group : str, optional
    The label in <code>category_column</code> that defines the reference group for the alternative hypothesis.
    If not provided, the first group is determined by the order of unique values in <code>category_column</code>.</p>
<h6 id="pagri_data_tools.pagri_stats.mannwhitneyu_report--returns">Returns:</h6>
<p>None</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span>
<span class="normal">2862</span>
<span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span>
<span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span>
<span class="normal">2871</span>
<span class="normal">2872</span>
<span class="normal">2873</span>
<span class="normal">2874</span>
<span class="normal">2875</span>
<span class="normal">2876</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mannwhitneyu_report</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">category_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">numeric_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span>
    <span class="n">reference_group</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform Mann-Whitney U rank test and generate a detailed report.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        The DataFrame containing the data for analysis.</span>
<span class="sd">    category_column : str</span>
<span class="sd">        The name of the column in `df` that contains the group labels (categories).</span>
<span class="sd">        This column should have exactly two unique values representing the two groups to compare.</span>
<span class="sd">    numeric_column : str</span>
<span class="sd">        The name of the column in `df` that contains the numeric values to compare between the two groups.</span>
<span class="sd">    alpha : float, optional</span>
<span class="sd">        The significance level for the hypothesis tests. Default is 0.05.</span>
<span class="sd">    alternative : str, optional</span>
<span class="sd">        The alternative hypothesis for test. Possible values are:</span>
<span class="sd">        - &#39;two-sided&#39; or &#39;2s&#39;: The means of the two groups are not equal (default).</span>
<span class="sd">        - &#39;larger&#39; or &#39;l&#39;: The mean of the first group is larger than the mean of the second group.</span>
<span class="sd">        - &#39;smaller&#39; or &#39;s&#39;: The mean of the first group is smaller than the mean of the second group.</span>
<span class="sd">    reference_group : str, optional</span>
<span class="sd">        The label in `category_column` that defines the reference group for the alternative hypothesis.</span>
<span class="sd">        If not provided, the first group is determined by the order of unique values in `category_column`.</span>

<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the category column exists in the DataFrame</span>
    <span class="k">if</span> <span class="n">category_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">category_column</span><span class="si">}</span><span class="s2">&#39; not found in DataFrame.&quot;</span><span class="p">)</span>
    <span class="c1"># Check if the numeric column exists in the DataFrame</span>
    <span class="k">if</span> <span class="n">numeric_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">numeric_column</span><span class="si">}</span><span class="s2">&#39; not found in DataFrame.&quot;</span><span class="p">)</span>
    <span class="c1"># Ensure the numeric column contains numeric data</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numeric_column</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">numeric_column</span><span class="si">}</span><span class="s2">&#39; must contain numeric data.&quot;</span><span class="p">)</span>

    <span class="c1"># Verify that the category column contains exactly two unique groups</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">category_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">category_column</span><span class="si">}</span><span class="s2">&#39; must contain exactly two unique groups.&quot;</span><span class="p">)</span>

    <span class="c1"># Remove missing values from the data</span>
    <span class="n">df_clean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Так как распределения средних далеки от нормальных, то будем использовать тест Манна-Уитни&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="c1"># State the null and alternative hypotheses</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 1: Формулировка гипотез.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H0: Распределения в двух группах одинаковы.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H1: Распределения в двух группах отличаются.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 2: Выбор уровня значимости и альтернативы.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Уровень значимости alpha выберем </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Альтернативная гипотеза: </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="c1"># Check the sample size in each group</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 3: Проверка размеров групп.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="n">display</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[</span><span class="n">category_column</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">())</span>

    <span class="c1"># Perform test</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 4: Проведение теста.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="n">mannwhitneyu_df</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]]</span>
                      <span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span>
                      <span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="n">alternative</span>
                      <span class="p">,</span> <span class="n">reference_group</span><span class="o">=</span><span class="n">reference_group</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.plot_feature_importances_classifier" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_feature_importances_classifier</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">titles_for_axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <div class="highlight"><pre><span></span><code>Plot the feature importances of a random forest classifier using Plotly Express.

Parameters:
df (pandas.DataFrame): The input DataFrame containing the features and target variable.
target (str): The name of the target variable column in the DataFrame.
titles_for_axis (dict):  A dictionary containing titles for the axes.
title (str): Title.

Returns:
fig (plotly.graph_objs.Figure): The feature importance plot.

Notes:
This function trains a random forest classifier on the input DataFrame, extracts the feature importances,
and plots them using Plotly Express. 
Examples:
    titles_for_axis = dict(
        debt = &#39;долга&#39;
        , children = &#39;Кол-во детей&#39;
        , age = &#39;Возраст&#39;
        , total_income = &#39;Доход&#39;)
</code></pre></div>
<p>)</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_feature_importances_classifier</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">titles_for_axis</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the feature importances of a random forest classifier using Plotly Express.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): The input DataFrame containing the features and target variable.</span>
<span class="sd">    target (str): The name of the target variable column in the DataFrame.</span>
<span class="sd">    titles_for_axis (dict):  A dictionary containing titles for the axes.</span>
<span class="sd">    title (str): Title.</span>

<span class="sd">    Returns:</span>
<span class="sd">    fig (plotly.graph_objs.Figure): The feature importance plot.</span>

<span class="sd">    Notes:</span>
<span class="sd">    This function trains a random forest classifier on the input DataFrame, extracts the feature importances,</span>
<span class="sd">    and plots them using Plotly Express. </span>
<span class="sd">    Examples:</span>
<span class="sd">        titles_for_axis = dict(</span>
<span class="sd">            debt = &#39;долга&#39;</span>
<span class="sd">            , children = &#39;Кол-во детей&#39;</span>
<span class="sd">            , age = &#39;Возраст&#39;</span>
<span class="sd">            , total_income = &#39;Доход&#39;)</span>
<span class="sd">)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Select numeric columns and the target variable</span>
    <span class="n">num_columns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])]</span>
    <span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">num_columns</span> <span class="o">+</span> <span class="p">[</span><span class="n">target</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">df_features</span> <span class="o">=</span> <span class="n">df_tmp</span><span class="p">[</span><span class="n">num_columns</span><span class="p">]</span>
    <span class="n">target_str</span> <span class="o">=</span> <span class="n">target</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">df_tmp</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>
    <span class="c1"># Get the feature names</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span>
    <span class="k">if</span> <span class="n">titles_for_axis</span><span class="p">:</span>
        <span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="n">titles_for_axis</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features</span><span class="p">]</span>
        <span class="n">target_str</span> <span class="o">=</span> <span class="n">titles_for_axis</span><span class="p">[</span><span class="n">target_str</span><span class="p">]</span>
    <span class="c1"># Normalize the data using Standard Scaler</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">df_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_features</span><span class="p">)</span>

    <span class="c1"># Train a random forest classifier</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

    <span class="c1"># Get the feature importances</span>
    <span class="n">importances</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">feature_importances_</span>
    <span class="n">feature_importances</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span><span class="s1">&#39;Feature&#39;</span><span class="p">:</span> <span class="n">features</span><span class="p">,</span> <span class="s1">&#39;Importance&#39;</span><span class="p">:</span> <span class="n">importances</span><span class="p">})</span>

    <span class="c1"># Sort the feature importances in descending order</span>
    <span class="n">feature_importances</span> <span class="o">=</span> <span class="n">feature_importances</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
        <span class="s1">&#39;Importance&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Create the bar chart</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">title</span><span class="o">=</span><span class="n">title</span> <span class="c1"># f&#39;График важности признаков для предсказания {target}&#39;</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;График важности признаков&#39;</span>        
    <span class="c1"># Create the bar chart</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">feature_importances</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Importance&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feature&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">categoryorder</span><span class="o">=</span><span class="s1">&#39;total ascending&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Название признака&#39;</span><span class="p">)),</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">),</span>
                   <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Оценка важности&#39;</span><span class="p">),</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.1)&quot;</span><span class="p">),</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span>  <span class="c1"># Set the width of the graph</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>  <span class="c1"># Set the height of the graph</span>
        <span class="n">template</span><span class="o">=</span><span class="s1">&#39;simple_white&#39;</span><span class="p">,</span>  <span class="c1"># Set the template to simple_white</span>
        <span class="n">title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.7)&quot;</span><span class="p">),</span>     
        <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s2">&quot;Segoe UI&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.7)&quot;</span><span class="p">),</span>
        <span class="n">xaxis_title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.7)&quot;</span><span class="p">),</span>
        <span class="n">yaxis_title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.7)&quot;</span><span class="p">),</span>
        <span class="n">xaxis_tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.7)&quot;</span><span class="p">),</span>
        <span class="n">yaxis_tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.7)&quot;</span><span class="p">),</span>
        <span class="n">xaxis_linecolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.4)&quot;</span><span class="p">,</span>
        <span class="n">yaxis_linecolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.4)&quot;</span><span class="p">,</span> 
        <span class="n">xaxis_tickcolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.4)&quot;</span><span class="p">,</span>
        <span class="n">yaxis_tickcolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.4)&quot;</span><span class="p">,</span>  
        <span class="n">legend_title_font_color</span><span class="o">=</span><span class="s1">&#39;rgba(0, 0, 0, 0.7)&#39;</span><span class="p">,</span>
        <span class="n">legend_font_color</span><span class="o">=</span><span class="s1">&#39;rgba(0, 0, 0, 0.7)&#39;</span><span class="p">,</span>
        <span class="c1"># xaxis_linewidth=2,</span>
        <span class="c1"># yaxis_linewidth=2</span>
        <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">70</span><span class="p">),</span>
        <span class="n">hoverlabel</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">),</span>
        <span class="c1"># xaxis=dict(</span>
        <span class="c1">#     showgrid=True</span>
        <span class="c1">#     , gridwidth=1</span>
        <span class="c1">#     , gridcolor=&quot;rgba(0, 0, 0, 0.1)&quot;</span>
        <span class="c1"># ),</span>
        <span class="c1"># yaxis=dict(</span>
        <span class="c1">#     showgrid=True</span>
        <span class="c1">#     , gridwidth=1</span>
        <span class="c1">#     , gridcolor=&quot;rgba(0, 0, 0, 0.07)&quot;</span>
        <span class="c1"># )        </span>
    <span class="p">)</span>
    <span class="c1"># Set the bar color to mediumpurple</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;rgba(128, 60, 170, 0.9)&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.plot_feature_importances_regression" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_feature_importances_regression</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">titles_for_axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Plot the feature importances of a random forest regressor using Plotly Express.</p>
<p>Parameters:
df (pandas.DataFrame): The input DataFrame containing the features and target variable.
target (str): The name of the target variable column in the DataFrame.
titles_for_axis (dict):  A dictionary containing titles for the axes.
title (str): Title.
Returns:
fig (plotly.graph_objs.Figure): The feature importance plot.</p>
<p>Notes:
This function trains a random forest classifier on the input DataFrame, extracts the feature importances,
and plots them using Plotly Express. 
Examples:
    titles_for_axis = dict(
        debt = 'долга'
        , children = 'Кол-во детей'
        , age = 'Возраст'
        , total_income = 'Доход')
    title = 'График важности признаков для предсказания цены'
Notes:
This function trains a random forest regressor on the input DataFrame, extracts the feature importances,
and plots them using Plotly Express.</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_feature_importances_regression</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">titles_for_axis</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the feature importances of a random forest regressor using Plotly Express.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    df (pandas.DataFrame): The input DataFrame containing the features and target variable.</span>
<span class="sd">    target (str): The name of the target variable column in the DataFrame.</span>
<span class="sd">    titles_for_axis (dict):  A dictionary containing titles for the axes.</span>
<span class="sd">    title (str): Title.</span>
<span class="sd">    Returns:</span>
<span class="sd">    fig (plotly.graph_objs.Figure): The feature importance plot.</span>

<span class="sd">    Notes:</span>
<span class="sd">    This function trains a random forest classifier on the input DataFrame, extracts the feature importances,</span>
<span class="sd">    and plots them using Plotly Express. </span>
<span class="sd">    Examples:</span>
<span class="sd">        titles_for_axis = dict(</span>
<span class="sd">            debt = &#39;долга&#39;</span>
<span class="sd">            , children = &#39;Кол-во детей&#39;</span>
<span class="sd">            , age = &#39;Возраст&#39;</span>
<span class="sd">            , total_income = &#39;Доход&#39;)</span>
<span class="sd">        title = &#39;График важности признаков для предсказания цены&#39;</span>
<span class="sd">    Notes:</span>
<span class="sd">    This function trains a random forest regressor on the input DataFrame, extracts the feature importances,</span>
<span class="sd">    and plots them using Plotly Express.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Select numeric columns and the target variable</span>
    <span class="n">num_columns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])]</span>
    <span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">num_columns</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">df_features</span> <span class="o">=</span> <span class="n">df_tmp</span><span class="p">[</span><span class="n">num_columns</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>
    <span class="n">target_series</span> <span class="o">=</span> <span class="n">df_tmp</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>
    <span class="c1"># Get the feature names</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span>
    <span class="k">if</span> <span class="n">titles_for_axis</span><span class="p">:</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">titles_for_axis</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">feature_names</span><span class="p">]</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">titles_for_axis</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>
    <span class="c1"># Normalize the data using Standard Scaler</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">scaled_data</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_features</span><span class="p">)</span>

    <span class="c1"># Train a random forest regressor</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span> <span class="n">target_series</span><span class="p">)</span>

    <span class="c1"># Get the feature importances</span>
    <span class="n">importances</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">feature_importances_</span>
    <span class="n">feature_importances</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span><span class="s1">&#39;Feature&#39;</span><span class="p">:</span> <span class="n">feature_names</span><span class="p">,</span> <span class="s1">&#39;Importance&#39;</span><span class="p">:</span> <span class="n">importances</span><span class="p">})</span>

    <span class="c1"># Sort the feature importances in descending order</span>
    <span class="n">feature_importances</span> <span class="o">=</span> <span class="n">feature_importances</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
        <span class="s1">&#39;Importance&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">title</span><span class="o">=</span><span class="n">title</span> <span class="c1"># f&#39;График важности признаков для предсказания {target}&#39;</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;График важности признаков&#39;</span>
    <span class="c1"># Create the bar chart</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">feature_importances</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Importance&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feature&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">categoryorder</span><span class="o">=</span><span class="s1">&#39;total ascending&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Название признака&#39;</span><span class="p">)),</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.5)&quot;</span><span class="p">),</span>
                   <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Оценка важности&#39;</span><span class="p">),</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.1)&quot;</span><span class="p">),</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span>  <span class="c1"># Set the width of the graph</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>  <span class="c1"># Set the height of the graph</span>
        <span class="n">template</span><span class="o">=</span><span class="s1">&#39;simple_white&#39;</span><span class="p">,</span>  <span class="c1"># Set the template to simple_white</span>
        <span class="n">title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.7)&quot;</span><span class="p">),</span>     
        <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s2">&quot;Segoe UI&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.7)&quot;</span><span class="p">),</span>
        <span class="n">xaxis_title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.7)&quot;</span><span class="p">),</span>
        <span class="n">yaxis_title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.7)&quot;</span><span class="p">),</span>
        <span class="n">xaxis_tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.7)&quot;</span><span class="p">),</span>
        <span class="n">yaxis_tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.7)&quot;</span><span class="p">),</span>
        <span class="n">xaxis_linecolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.4)&quot;</span><span class="p">,</span>
        <span class="n">yaxis_linecolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.4)&quot;</span><span class="p">,</span> 
        <span class="n">xaxis_tickcolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.4)&quot;</span><span class="p">,</span>
        <span class="n">yaxis_tickcolor</span><span class="o">=</span><span class="s2">&quot;rgba(0, 0, 0, 0.4)&quot;</span><span class="p">,</span>  
        <span class="n">legend_title_font_color</span><span class="o">=</span><span class="s1">&#39;rgba(0, 0, 0, 0.7)&#39;</span><span class="p">,</span>
        <span class="n">legend_font_color</span><span class="o">=</span><span class="s1">&#39;rgba(0, 0, 0, 0.7)&#39;</span><span class="p">,</span>
        <span class="c1"># xaxis_linewidth=2,</span>
        <span class="c1"># yaxis_linewidth=2</span>
        <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">70</span><span class="p">),</span>
        <span class="n">hoverlabel</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">),</span>
        <span class="c1"># xaxis=dict(</span>
        <span class="c1">#     showgrid=True</span>
        <span class="c1">#     , gridwidth=1</span>
        <span class="c1">#     , gridcolor=&quot;rgba(0, 0, 0, 0.1)&quot;</span>
        <span class="c1"># ),</span>
        <span class="c1"># yaxis=dict(</span>
        <span class="c1">#     showgrid=True</span>
        <span class="c1">#     , gridwidth=1</span>
        <span class="c1">#     , gridcolor=&quot;rgba(0, 0, 0, 0.07)&quot;</span>
        <span class="c1"># )        </span>
    <span class="p">)</span>
    <span class="c1"># Set the bar color to mediumpurple</span>
    <span class="n">hovertemplate</span> <span class="o">=</span> <span class="s1">&#39;Оценка важности = %</span><span class="si">{x}</span><span class="s1">&lt;br&gt;Название признака = %</span><span class="si">{y}</span><span class="s1">&lt;extra&gt;&lt;/extra&gt;&#39;</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;rgba(128, 60, 170, 0.9)&#39;</span><span class="p">,</span> <span class="n">hovertemplate</span><span class="o">=</span><span class="n">hovertemplate</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.proportion_ztest_1sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">proportion_ztest_1sample</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a one-sample z-test for a proportion.</p>
<p>Parameters:
- count (int): Number of successes in the sample
- n (int): Total number of observations in the sample
- p0 (float): Known population proportion under the null hypothesis
- alpha (float, optional): Significance level (default: 0.05)
- alternative (str, optional): Alternative hypothesis ('two-sided', '2s', 'larger', 'l', 'smaller', 's') (default: 'two-sided')
- return_results (bool, optional): Return (z_stat, p_value) instead of printing (default=False)</p>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - zstat : (float)
        test statistic for the z-test
    - p-value : (float)
        p-value for the z-test</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">proportion_ztest_1sample</span><span class="p">(</span><span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a one-sample z-test for a proportion.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - count (int): Number of successes in the sample</span>
<span class="sd">    - n (int): Total number of observations in the sample</span>
<span class="sd">    - p0 (float): Known population proportion under the null hypothesis</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - alternative (str, optional): Alternative hypothesis (&#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;) (default: &#39;two-sided&#39;)</span>
<span class="sd">    - return_results (bool, optional): Return (z_stat, p_value) instead of printing (default=False)</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - zstat : (float)</span>
<span class="sd">            test statistic for the z-test</span>
<span class="sd">        - p-value : (float)</span>
<span class="sd">            p-value for the z-test</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">n</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;count and n must be integers&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="n">p0</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">p0</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;p0 must be a float between 0 and 1&quot;</span><span class="p">)</span>

    <span class="n">z_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">proportions_ztest</span><span class="p">(</span>
        <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">,</span> <span class="n">nobs</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="n">alternative</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Один выборочный Z-тест для доли&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">z_stat</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.proportions_chi2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">proportions_chi2</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a chi-squared test for proportions.</p>
<p>Parameters:
- count1 (int): Number of successes in the first sample
- count2 (int): Number of successes in the second sample
- n1 (int): Total number of observations in the first sample
- n2 (int): Total number of observations in the second sample
- alpha (float, optional): Significance level (default: 0.05)
- alternative (str, optional): Alternative hypothesis ('two-sided', '2s', 'larger', 'l', 'smaller', 's') (default: 'two-sided')
- return_results (bool, optional): Return (chi2_stat, p_value) instead of printing (default=False)</p>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - chi2_stat : (float)
        test statistic for the chi-squared test, asymptotically chi-squared distributed
    - p-value : (float)
        p-value for the chi-squared test</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">proportions_chi2</span><span class="p">(</span><span class="n">count1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">count2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a chi-squared test for proportions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - count1 (int): Number of successes in the first sample</span>
<span class="sd">    - count2 (int): Number of successes in the second sample</span>
<span class="sd">    - n1 (int): Total number of observations in the first sample</span>
<span class="sd">    - n2 (int): Total number of observations in the second sample</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - alternative (str, optional): Alternative hypothesis (&#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;) (default: &#39;two-sided&#39;)</span>
<span class="sd">    - return_results (bool, optional): Return (chi2_stat, p_value) instead of printing (default=False)</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - chi2_stat : (float)</span>
<span class="sd">            test statistic for the chi-squared test, asymptotically chi-squared distributed</span>
<span class="sd">        - p-value : (float)</span>
<span class="sd">            p-value for the chi-squared test</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">count1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All input parameters must be integers&quot;</span><span class="p">)</span>

    <span class="n">chi2_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">test_proportions_2indep</span><span class="p">(</span>
        <span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="n">alternative</span><span class="p">)</span><span class="o">.</span><span class="n">tuple</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Хи-квадрат тест для долей&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">chi2_stat</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.proportions_chi2_column" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">proportions_chi2_column</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a chi-squared test for proportions on a single column.</p>
<p>Parameters:
- column (pandas Series): The input column with two unique values.
- alpha (float, optional): The significance level (default=0.05).
- alternative (str, optional): The alternative hypothesis ('two-sided', '2s', 'larger', 'l', 'smaller', 's') (default='two-sided').
- return_results (bool, optional): Return (chi2_stat, p_value) instead of printing (default=False).</p>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - chi2_stat : (float)
        test statistic for the chi-squared test, asymptotically chi-squared distributed
    - p-value : (float)
        p-value for the chi-squared test</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">proportions_chi2_column</span><span class="p">(</span><span class="n">column</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a chi-squared test for proportions on a single column.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - column (pandas Series): The input column with two unique values.</span>
<span class="sd">    - alpha (float, optional): The significance level (default=0.05).</span>
<span class="sd">    - alternative (str, optional): The alternative hypothesis (&#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;) (default=&#39;two-sided&#39;).</span>
<span class="sd">    - return_results (bool, optional): Return (chi2_stat, p_value) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - chi2_stat : (float)</span>
<span class="sd">            test statistic for the chi-squared test, asymptotically chi-squared distributed</span>
<span class="sd">        - p-value : (float)</span>
<span class="sd">            p-value for the chi-squared test</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input column must be pd.Series&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input column must have at least one value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;column must not have missing values.</span><span class="se">\n</span><span class="s1">column have </span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;column must have exactly two unique values.</span><span class="se">\n</span><span class="s1">column have </span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s1"> unique values&#39;</span><span class="p">)</span>

    <span class="n">value_counts</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">count1</span> <span class="o">=</span> <span class="n">value_counts</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">count2</span> <span class="o">=</span> <span class="n">value_counts</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">size</span>

    <span class="n">chi2_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">test_proportions_2indep</span><span class="p">(</span>
        <span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="n">alternative</span><span class="p">)</span><span class="o">.</span><span class="n">tuple</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Хи-квадрат тест для долей&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">chi2_stat</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.proportions_ztest_2sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">proportions_ztest_2sample</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a z-test for proportions.</p>
<p>Parameters:
- count1 (int): Number of successes in the first sample
- count2 (int): Number of successes in the second sample
- n1 (int): Total number of observations in the first sample
- n2 (int): Total number of observations in the second sample
- alpha (float, optional): Significance level (default: 0.05)
- alternative (str, optional): Alternative hypothesis ('two-sided', '2s', 'larger', 'l', 'smaller', 's') (default: 'two-sided')
- return_results (bool, optional): Return (z_stat, p_value) instead of printing (default=False).</p>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - zstat : (float)
        test statistic for the z-test
    - p-value : (float)
        p-value for the z-test</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">proportions_ztest_2sample</span><span class="p">(</span><span class="n">count1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">count2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a z-test for proportions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - count1 (int): Number of successes in the first sample</span>
<span class="sd">    - count2 (int): Number of successes in the second sample</span>
<span class="sd">    - n1 (int): Total number of observations in the first sample</span>
<span class="sd">    - n2 (int): Total number of observations in the second sample</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - alternative (str, optional): Alternative hypothesis (&#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;) (default: &#39;two-sided&#39;)</span>
<span class="sd">    - return_results (bool, optional): Return (z_stat, p_value) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - zstat : (float)</span>
<span class="sd">            test statistic for the z-test</span>
<span class="sd">        - p-value : (float)</span>
<span class="sd">            p-value for the z-test</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">count1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All input parameters must be integers&quot;</span><span class="p">)</span>
    <span class="n">count</span> <span class="o">=</span> <span class="p">[</span><span class="n">count1</span><span class="p">,</span> <span class="n">count2</span><span class="p">]</span>
    <span class="n">nobs</span> <span class="o">=</span> <span class="p">[</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">]</span>
    <span class="n">z_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">proportions_ztest</span><span class="p">(</span>
        <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">,</span> <span class="n">nobs</span><span class="o">=</span><span class="n">nobs</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="n">alternative</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Z тест для долей&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">z_stat</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.proportions_ztest_column_2sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">proportions_ztest_column_2sample</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a z-test for proportions on a single column.</p>
<p>Parameters:
- column (pandas Series): The input column with two unique values.
- alpha (float, optional): The significance level (default=0.05).
- alternative (str, optional): The alternative hypothesis ('two-sided', '2s', 'larger', 'l', 'smaller', 's') (default='two-sided').
- return_results (bool, optional): Return (z_stat, p_value) instead of printing (default=False).</p>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - zstat : (float)
        test statistic for the z-test
    - p-value : (float)
        p-value for the z-test</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">proportions_ztest_column_2sample</span><span class="p">(</span><span class="n">column</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a z-test for proportions on a single column.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - column (pandas Series): The input column with two unique values.</span>
<span class="sd">    - alpha (float, optional): The significance level (default=0.05).</span>
<span class="sd">    - alternative (str, optional): The alternative hypothesis (&#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;) (default=&#39;two-sided&#39;).</span>
<span class="sd">    - return_results (bool, optional): Return (z_stat, p_value) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - zstat : (float)</span>
<span class="sd">            test statistic for the z-test</span>
<span class="sd">        - p-value : (float)</span>
<span class="sd">            p-value for the z-test</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;smaller&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input column must be pd.Series&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input column must have at least one value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;column must not have missing values.</span><span class="se">\n</span><span class="s1">column have </span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;column must have exactly two unique values.</span><span class="se">\n</span><span class="s1">column have </span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s1"> unique values&#39;</span><span class="p">)</span>

    <span class="n">value_counts</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">count1</span> <span class="o">=</span> <span class="n">value_counts</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">count2</span> <span class="o">=</span> <span class="n">value_counts</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">count1</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">count2</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">count1</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">or</span> <span class="n">count2</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>

    <span class="n">n1</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">size</span>
    <span class="n">count</span> <span class="o">=</span> <span class="p">[</span><span class="n">count1</span><span class="p">,</span> <span class="n">count2</span><span class="p">]</span>
    <span class="n">nobs</span> <span class="o">=</span> <span class="p">[</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">]</span>

    <span class="n">z_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stm</span><span class="o">.</span><span class="n">proportions_ztest</span><span class="p">(</span>
        <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">,</span> <span class="n">nobs</span><span class="o">=</span><span class="n">nobs</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="n">alternative</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Z тест для долей&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">z_stat</span><span class="p">,</span> <span class="n">p_value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.ttest_ind" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ttest_ind</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform t-test for independent samples.</p>
<p>Parameters:
- sample1 (pd.Series): First sample values
- sample2 (pd.Series): Second sample values
- alpha (float, optional): Significance level (default: 0.05)
- equal_var (bool, optional): If True (default), perform a standard independent 2 sample test that assumes equal population variances.<br />
    If False, perform Welch's t-test, which does not assume equal population variance.
- alternative (str, optional): Alternative hypothesis ('two-sided', '2s', 'larger', 'l', 'smaller', 's') (default: 'two-sided')
- return_results (bool, optional): Return (statistic, p_value, beta, cohens_d) instead of printing (default=False).</p>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - statistic : (float or array)
        The calculated t-statistic.
    - pvalue : (float or array)
        The two-tailed p-value.
    - beta : (float)
        The probability of Type II error (beta).
    - cohens_d : (float)
        The effect size (Cohen's d).</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ttest_ind</span><span class="p">(</span><span class="n">sample1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">sample2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform t-test for independent samples.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - sample1 (pd.Series): First sample values</span>
<span class="sd">    - sample2 (pd.Series): Second sample values</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - equal_var (bool, optional): If True (default), perform a standard independent 2 sample test that assumes equal population variances.  </span>
<span class="sd">        If False, perform Welch&#39;s t-test, which does not assume equal population variance.</span>
<span class="sd">    - alternative (str, optional): Alternative hypothesis (&#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;) (default: &#39;two-sided&#39;)</span>
<span class="sd">    - return_results (bool, optional): Return (statistic, p_value, beta, cohens_d) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - statistic : (float or array)</span>
<span class="sd">            The calculated t-statistic.</span>
<span class="sd">        - pvalue : (float or array)</span>
<span class="sd">            The two-tailed p-value.</span>
<span class="sd">        - beta : (float)</span>
<span class="sd">            The probability of Type II error (beta).</span>
<span class="sd">        - cohens_d : (float)</span>
<span class="sd">            The effect size (Cohen&#39;s d).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;greater&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;greater&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;less&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;less&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input samples must be pd.Series&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All samples must have at least one value&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">sample2</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;sample1 and sample2 must contain numeric values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sample1</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">sample2</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;sample1 and sample2 must not have missing values.</span><span class="se">\n</span><span class="s1">sample1 have </span><span class="si">{</span><span class="n">sample1</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values</span><span class="se">\n</span><span class="s1">sample2 have </span><span class="si">{</span><span class="n">sample2</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="n">nobs1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>
    <span class="n">nobs2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span>
    <span class="c1"># Calculate Cohen&#39;s d</span>
    <span class="n">cohens_d</span> <span class="o">=</span> <span class="n">calculate_cohens_d</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="n">equal_var</span><span class="p">)</span>
    <span class="c1"># Calculate the power of the test</span>
    <span class="n">power</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">TTestIndPower</span><span class="p">()</span><span class="o">.</span><span class="n">solve_power</span><span class="p">(</span>
        <span class="n">effect_size</span><span class="o">=</span><span class="n">cohens_d</span><span class="p">,</span> <span class="n">nobs1</span><span class="o">=</span><span class="n">nobs1</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="n">nobs2</span><span class="o">/</span><span class="n">nobs1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="c1"># Calculate the type II error rate (β)</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">power</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span>
        <span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="n">equal_var</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="n">alternative</span><span class="p">)</span>
    <span class="n">statistic</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">statistic</span>
    <span class="n">p_value</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">pvalue</span>
    <span class="n">ci_low</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">confidence_interval</span><span class="p">()</span><span class="o">.</span><span class="n">low</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ci_high</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">confidence_interval</span><span class="p">()</span><span class="o">.</span><span class="n">high</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T-критерий Уэлча&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;beta = &#39;</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ci = (</span><span class="si">{</span><span class="n">ci_low</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">ci_high</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">cohens_d</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.ttest_ind_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ttest_ind_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">reference_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform t-test for independent samples.</p>
        <ul>
<li>df (pd.DataFrame): DataFrame containing two columns,
    where the first column contains sample labels (e.g., "male" and "female") and
    the second column contains corresponding values</li>
<li>alpha (float, optional): Significance level (default: 0.05)</li>
<li>equal_var (bool, optional): If True (default), perform a standard independent 2 sample test that assumes equal population variances.<br />
    If False, perform Welch's t-test, which does not assume equal population variance.</li>
<li>alternative (str, optional): Alternative hypothesis ('two-sided', '2s', 'larger', 'l', 'smaller', 's') (default: 'two-sided')</li>
<li>reference_group (str, optional): Lable name in first column of df for define first sample for scipy.stats.ttest_ind</li>
<li>return_results (bool, optional): Return (statistic, p_value, beta, cohens_d) instead of printing (default=False).</li>
</ul>
<p>Returns:
- If return_results is False: None
- If return_results is True
    - statistic : (float or array)
        The calculated t-statistic.
    - pvalue : (float or array)
        The two-tailed p-value.
    - beta : (float)
        The probability of Type II error (beta).
    - cohens_d : (float)
        The effect size (Cohen's d).</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ttest_ind_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">reference_group</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform t-test for independent samples.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - df (pd.DataFrame): DataFrame containing two columns,</span>
<span class="sd">        where the first column contains sample labels (e.g., &quot;male&quot; and &quot;female&quot;) and</span>
<span class="sd">        the second column contains corresponding values</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>
<span class="sd">    - equal_var (bool, optional): If True (default), perform a standard independent 2 sample test that assumes equal population variances.  </span>
<span class="sd">        If False, perform Welch&#39;s t-test, which does not assume equal population variance.</span>
<span class="sd">    - alternative (str, optional): Alternative hypothesis (&#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;) (default: &#39;two-sided&#39;)</span>
<span class="sd">    - reference_group (str, optional): Lable name in first column of df for define first sample for scipy.stats.ttest_ind</span>
<span class="sd">    - return_results (bool, optional): Return (statistic, p_value, beta, cohens_d) instead of printing (default=False).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - If return_results is False: None</span>
<span class="sd">    - If return_results is True</span>
<span class="sd">        - statistic : (float or array)</span>
<span class="sd">            The calculated t-statistic.</span>
<span class="sd">        - pvalue : (float or array)</span>
<span class="sd">            The two-tailed p-value.</span>
<span class="sd">        - beta : (float)</span>
<span class="sd">            The probability of Type II error (beta).</span>
<span class="sd">        - cohens_d : (float)</span>
<span class="sd">            The effect size (Cohen&#39;s d).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;two-sided&quot;</span><span class="p">,</span> <span class="s2">&quot;2s&quot;</span><span class="p">,</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;smaller&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;alternative must be &#39;two-sided&#39;, &#39;2s&#39;, &#39;larger&#39;, &#39;l&#39;, &#39;smaller&#39;, &#39;s&#39;, but got </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">alternative_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2s&quot;</span><span class="p">:</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
        <span class="s2">&quot;larger&quot;</span><span class="p">:</span> <span class="s2">&quot;greater&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;greater&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smaller&quot;</span><span class="p">:</span> <span class="s2">&quot;less&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;less&quot;</span>
    <span class="p">}</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">alternative_map</span><span class="p">[</span><span class="n">alternative</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input df must be pd.DataFrame&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input DataFrame must have exactly two columns&quot;</span><span class="p">)</span>

    <span class="n">sample_column</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">value_column</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">value_column</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value column must contain numeric values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sample_column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">value_column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;sample_column and value_column must not have missing values.</span><span class="se">\n</span><span class="s1">sample_column have </span><span class="si">{</span><span class="n">sample_column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values</span><span class="se">\n</span><span class="s1">value_column have </span><span class="si">{</span><span class="n">value_column</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="n">unique_samples</span> <span class="o">=</span> <span class="n">sample_column</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_samples</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Sample column must contain exactly two unique labels&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reference_group</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">reference_group</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_samples</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;reference_group must be a lable in first column of df&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reference_group</span> <span class="o">!=</span> <span class="n">unique_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">unique_samples</span> <span class="o">=</span> <span class="n">unique_samples</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sample1</span> <span class="o">=</span> <span class="n">value_column</span><span class="p">[</span><span class="n">sample_column</span> <span class="o">==</span> <span class="n">unique_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">sample2</span> <span class="o">=</span> <span class="n">value_column</span><span class="p">[</span><span class="n">sample_column</span> <span class="o">==</span> <span class="n">unique_samples</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="p">[</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each sample must have at least two elements&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">warning_issued</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">warning_issued</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Warning: Sample size is less than 30 for one or more samples. Results may be unreliable.&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>

    <span class="n">nobs1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>
    <span class="n">nobs2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span>
    <span class="c1"># Calculate Cohen&#39;s d</span>
    <span class="n">cohens_d</span> <span class="o">=</span> <span class="n">calculate_cohens_d</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="n">equal_var</span><span class="p">)</span>
    <span class="c1"># Calculate the power of the test</span>
    <span class="n">power</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">TTestIndPower</span><span class="p">()</span><span class="o">.</span><span class="n">solve_power</span><span class="p">(</span>
        <span class="n">effect_size</span><span class="o">=</span><span class="n">cohens_d</span><span class="p">,</span> <span class="n">nobs1</span><span class="o">=</span><span class="n">nobs1</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="n">nobs2</span><span class="o">/</span><span class="n">nobs1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="c1"># Calculate the type II error rate (β)</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">power</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span>
        <span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="n">equal_var</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="n">alternative</span><span class="p">)</span>
    <span class="n">statistic</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">statistic</span>
    <span class="n">p_value</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">pvalue</span>
    <span class="n">ci_low</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">confidence_interval</span><span class="p">()</span><span class="o">.</span><span class="n">low</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ci_high</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">confidence_interval</span><span class="p">()</span><span class="o">.</span><span class="n">high</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>


    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T-критерий&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = &#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;beta = &#39;</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ci = (</span><span class="si">{</span><span class="n">ci_low</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">ci_high</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Отклоняем нулевую гипотезу, поскольку p-value меньше уровня значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span>
            <span class="s2">&quot;Нет оснований отвергнуть нулевую гипотезу, поскольку p-value больше или равно уровню значимости&quot;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">cohens_d</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.ttest_ind_report" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ttest_ind_report</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="n">reference_group</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform t-test for independent samples and generate a detailed report.</p>
<h6 id="pagri_data_tools.pagri_stats.ttest_ind_report--parameters">Parameters:</h6>
<p>df : pd.DataFrame
    The DataFrame containing the data for analysis.
category_column : str
    The name of the column in <code>df</code> that contains the group labels (categories).
    This column should have exactly two unique values representing the two groups to compare.
numeric_column : str
    The name of the column in <code>df</code> that contains the numeric values to compare between the two groups.
alpha : float, optional
    The significance level for the hypothesis tests. Default is 0.05.
alternative : str, optional
    The alternative hypothesis for the t-test. Possible values are:
    - 'two-sided' or '2s': The means of the two groups are not equal (default).
    - 'larger' or 'l': The mean of the first group is larger than the mean of the second group.
    - 'smaller' or 's': The mean of the first group is smaller than the mean of the second group.
reference_group : str, optional
    The label in <code>category_column</code> that defines the reference group for the alternative hypothesis.
    If not provided, the first group is determined by the order of unique values in <code>category_column</code>.</p>
<h6 id="pagri_data_tools.pagri_stats.ttest_ind_report--returns">Returns:</h6>
<p>None</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span>
<span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ttest_ind_report</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">category_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">numeric_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span>
    <span class="n">reference_group</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform t-test for independent samples and generate a detailed report.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        The DataFrame containing the data for analysis.</span>
<span class="sd">    category_column : str</span>
<span class="sd">        The name of the column in `df` that contains the group labels (categories).</span>
<span class="sd">        This column should have exactly two unique values representing the two groups to compare.</span>
<span class="sd">    numeric_column : str</span>
<span class="sd">        The name of the column in `df` that contains the numeric values to compare between the two groups.</span>
<span class="sd">    alpha : float, optional</span>
<span class="sd">        The significance level for the hypothesis tests. Default is 0.05.</span>
<span class="sd">    alternative : str, optional</span>
<span class="sd">        The alternative hypothesis for the t-test. Possible values are:</span>
<span class="sd">        - &#39;two-sided&#39; or &#39;2s&#39;: The means of the two groups are not equal (default).</span>
<span class="sd">        - &#39;larger&#39; or &#39;l&#39;: The mean of the first group is larger than the mean of the second group.</span>
<span class="sd">        - &#39;smaller&#39; or &#39;s&#39;: The mean of the first group is smaller than the mean of the second group.</span>
<span class="sd">    reference_group : str, optional</span>
<span class="sd">        The label in `category_column` that defines the reference group for the alternative hypothesis.</span>
<span class="sd">        If not provided, the first group is determined by the order of unique values in `category_column`.</span>

<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the category column exists in the DataFrame</span>
    <span class="k">if</span> <span class="n">category_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">category_column</span><span class="si">}</span><span class="s2">&#39; not found in DataFrame.&quot;</span><span class="p">)</span>
    <span class="c1"># Check if the numeric column exists in the DataFrame</span>
    <span class="k">if</span> <span class="n">numeric_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">numeric_column</span><span class="si">}</span><span class="s2">&#39; not found in DataFrame.&quot;</span><span class="p">)</span>
    <span class="c1"># Ensure the numeric column contains numeric data</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numeric_column</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">numeric_column</span><span class="si">}</span><span class="s2">&#39; must contain numeric data.&quot;</span><span class="p">)</span>

    <span class="c1"># Verify that the category column contains exactly two unique groups</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">category_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">category_column</span><span class="si">}</span><span class="s2">&#39; must contain exactly two unique groups.&quot;</span><span class="p">)</span>

    <span class="c1"># Remove missing values from the data</span>
    <span class="n">df_clean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Так как распределения средних близки к нормальным, то будем использовать параметрический тест.&#39;</span><span class="p">)</span>
    <span class="c1"># State the null and alternative hypotheses for the t-test</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 1: Формулировка гипотез.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H0: Средние значения в двух группах равны.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H1: Средние значения в двух группах не равны.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># State the null and alternative hypotheses for the Levene&#39;s test</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 2: Проверка равенства дисперсий.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H0: Дисперсии в двух группах равны.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;H1: Дисперсии в двух группах не равны.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Используем тест Левена для проверки равенства дисперсий.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Уровень значимости (alpha) установлен на </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="c1"># Perform Levene&#39;s test to check for equal variances</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">p_value_levene</span> <span class="o">=</span> <span class="n">levene_df</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">equal_var</span> <span class="o">=</span> <span class="n">p_value_levene</span> <span class="o">&gt;=</span> <span class="n">alpha</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 3: Выбор подходящего t-теста.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="c1"># Determine whether to use Welch&#39;s correction based on the Levene&#39;s test result</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">equal_var</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Так как дисперсии в группах разные, будем использовать тест Уэлча.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Так как нет оснований утверждать, что дисперсии в группах отличаются, используем стандартный t-тест.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Уровень значимости alpha выберем </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Альтернативная гипотеза: </span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="c1"># Check the sample size in each group</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 4: Проверка размеров групп.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="n">display</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[</span><span class="n">category_column</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">())</span>

    <span class="c1"># Perform the independent t-test (with or without Welch&#39;s correction)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Шаг 5: Проведение теста.&quot;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]))</span>
    <span class="n">ttest_ind_df</span><span class="p">(</span><span class="n">df_clean</span><span class="p">[[</span><span class="n">category_column</span><span class="p">,</span> <span class="n">numeric_column</span><span class="p">]]</span>
                      <span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span>
                      <span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="n">equal_var</span>
                      <span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="n">alternative</span>
                      <span class="p">,</span> <span class="n">reference_group</span><span class="o">=</span><span class="n">reference_group</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pagri_data_tools.pagri_stats.tukey_hsd_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tukey_hsd_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Perform a Tukey's HSD test for pairwise comparisons. <br />
This test is commonly used to identify significant differences between groups in an ANOVA analysis,</p>
        <ul>
<li>df (pd.DataFrame): DataFrame containing two columns,
    where the first column contains labels and
    the second column contains corresponding values</li>
<li>alpha (float, optional): Significance level (default: 0.05)</li>
</ul>
<p>Returns:
- None</p>


            <details class="quote">
              <summary>Source code in <code>pagri_data_tools/pagri_stats.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">tukey_hsd_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a Tukey&#39;s HSD test for pairwise comparisons.   </span>
<span class="sd">    This test is commonly used to identify significant differences between groups in an ANOVA analysis,</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - df (pd.DataFrame): DataFrame containing two columns,</span>
<span class="sd">        where the first column contains labels and</span>
<span class="sd">        the second column contains corresponding values</span>
<span class="sd">    - alpha (float, optional): Significance level (default: 0.05)</span>

<span class="sd">    Returns:</span>
<span class="sd">    - None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha must be between 0 and 1, but got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input df must be pd.DataFrame&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input DataFrame must have exactly two columns&quot;</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value column must contain numeric values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;labels and values must not have missing values.</span><span class="se">\n</span><span class="s1">labels have </span><span class="si">{</span><span class="n">labels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values</span><span class="se">\n</span><span class="s1">values have </span><span class="si">{</span><span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
    <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_labels</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Labels must contain at least two unique values&quot;</span><span class="p">)</span>

    <span class="n">tukey</span> <span class="o">=</span> <span class="n">pairwise_tukeyhsd</span><span class="p">(</span><span class="n">endog</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tukey</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>